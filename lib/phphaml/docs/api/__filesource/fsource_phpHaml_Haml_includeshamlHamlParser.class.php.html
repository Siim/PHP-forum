<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for HamlParser.class.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						<h1>Source for file HamlParser.class.php</h1>
<p>Documentation is available at <a href="../phpHaml/Haml/_includes_haml_HamlParser_class_php.html">HamlParser.class.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-doc">/**</span></li>
<li><a name="a3"></a><span class="src-doc"> * Haml parser.</span></li>
<li><a name="a4"></a><span class="src-doc"> *</span></li>
<li><a name="a5"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://haml.hamptoncatlin.com/ Original Haml parser (for Ruby)</span></li>
<li><a name="a6"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://phphaml.sourceforge.net/ Online documentation</span></li>
<li><a name="a7"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://sourceforge.net/projects/phphaml/ SourceForge project page</span></li>
<li><a name="a8"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@license</span><span class="src-doc"> http://www.opensource.org/licenses/mit-license.php MIT (X11) License</span></li>
<li><a name="a9"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Amadeusz Jasak &lt;amadeusz.jasak@gmail.com&gt;</span></li>
<li><a name="a10"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc"> phpHaml</span></li>
<li><a name="a11"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@subpackage</span><span class="src-doc"> Haml</span></li>
<li><a name="a12"></a><span class="src-doc"> */</span></li>
<li><a name="a13"></a>&nbsp;</li>
<li><a name="a14"></a><span class="src-inc">require_once </span><span class="src-id">dirname</span><span class="src-sym">(</span>__FILE__<span class="src-sym">) </span>. <span class="src-str">'/../common/CommonCache.class.php'</span><span class="src-sym">;</span></li>
<li><a name="a15"></a>&nbsp;</li>
<li><a name="a16"></a><span class="src-doc">/**</span></li>
<li><a name="a17"></a><span class="src-doc"> * Haml parser.</span></li>
<li><a name="a18"></a><span class="src-doc"> *</span></li>
<li><a name="a19"></a><span class="src-doc"> * Haml is templating language. It is very simple and clean.</span></li>
<li><a name="a20"></a><span class="src-doc"> * Example Haml code</span></li>
<li><a name="a21"></a><span class="src-doc"> * &lt;code&gt;</span></li>
<li><a name="a22"></a><span class="src-doc"> * !!! 1.1</span></li>
<li><a name="a23"></a><span class="src-doc"> * %html</span></li>
<li><a name="a24"></a><span class="src-doc"> *   %head</span></li>
<li><a name="a25"></a><span class="src-doc"> *     %title= $title ? $title : 'none'</span></li>
<li><a name="a26"></a><span class="src-doc"> *     %link{ :rel =&gt; 'stylesheet', :type =&gt; 'text/css', :href =&gt; &quot;$uri/tpl/$theme.css&quot; }</span></li>
<li><a name="a27"></a><span class="src-doc"> *   %body</span></li>
<li><a name="a28"></a><span class="src-doc"> *     #header</span></li>
<li><a name="a29"></a><span class="src-doc"> *       %h1.sitename example.com</span></li>
<li><a name="a30"></a><span class="src-doc"> *     #content</span></li>
<li><a name="a31"></a><span class="src-doc"> *       / Table with models</span></li>
<li><a name="a32"></a><span class="src-doc"> *       %table.config.list</span></li>
<li><a name="a33"></a><span class="src-doc"> *         %tr</span></li>
<li><a name="a34"></a><span class="src-doc"> *           %th ID</span></li>
<li><a name="a35"></a><span class="src-doc"> *           %th Name</span></li>
<li><a name="a36"></a><span class="src-doc"> *           %th Value</span></li>
<li><a name="a37"></a><span class="src-doc"> *         - foreach ($models as $model)</span></li>
<li><a name="a38"></a><span class="src-doc"> *           %tr[$model]</span></li>
<li><a name="a39"></a><span class="src-doc"> *             %td= $model-&gt;ID</span></li>
<li><a name="a40"></a><span class="src-doc"> *             %td= $model-&gt;name</span></li>
<li><a name="a41"></a><span class="src-doc"> *             %td= $model-&gt;value</span></li>
<li><a name="a42"></a><span class="src-doc"> *     #footer</span></li>
<li><a name="a43"></a><span class="src-doc"> *       %address.author Random Hacker</span></li>
<li><a name="a44"></a><span class="src-doc"> * &lt;/code&gt;</span></li>
<li><a name="a45"></a><span class="src-doc"> * Comparing to original Haml language I added:</span></li>
<li><a name="a46"></a><span class="src-doc"> * &lt;ul&gt;</span></li>
<li><a name="a47"></a><span class="src-doc"> *   &lt;li&gt;</span></li>
<li><a name="a48"></a><span class="src-doc"> *     Support to translations - use '$'</span></li>
<li><a name="a49"></a><span class="src-doc"> * &lt;code&gt;</span></li>
<li><a name="a50"></a><span class="src-doc"> * %strong$ Log in</span></li>
<li><a name="a51"></a><span class="src-doc"> * &lt;/code&gt;</span></li>
<li><a name="a52"></a><span class="src-doc"> *   &lt;/li&gt;</span></li>
<li><a name="a53"></a><span class="src-doc"> *   &lt;li&gt;</span></li>
<li><a name="a54"></a><span class="src-doc"> *     Including support ('!!') and level changing ('?')</span></li>
<li><a name="a55"></a><span class="src-doc"> * &lt;code&gt;</span></li>
<li><a name="a56"></a><span class="src-doc"> * !! html</span></li>
<li><a name="a57"></a><span class="src-doc"> * !! page.header?2</span></li>
<li><a name="a58"></a><span class="src-doc"> * %p?3</span></li>
<li><a name="a59"></a><span class="src-doc"> *   Foo bar</span></li>
<li><a name="a60"></a><span class="src-doc"> * !! page.footer?2</span></li>
<li><a name="a61"></a><span class="src-doc"> * &lt;/code&gt;</span></li>
<li><a name="a62"></a><span class="src-doc"> *   &lt;/li&gt;</span></li>
<li><a name="a63"></a><span class="src-doc"> * &lt;/ul&gt;</span></li>
<li><a name="a64"></a><span class="src-doc"> *</span></li>
<li><a name="a65"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://haml.hamptoncatlin.com/ Original Haml parser (for Ruby)</span></li>
<li><a name="a66"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://phphaml.sourceforge.net/ Online documentation</span></li>
<li><a name="a67"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc"> http://sourceforge.net/projects/phphaml/ SourceForge project page</span></li>
<li><a name="a68"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@license</span><span class="src-doc"> http://www.opensource.org/licenses/mit-license.php MIT (X11) License</span></li>
<li><a name="a69"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Amadeusz Jasak &lt;amadeusz.jasak@gmail.com&gt;</span></li>
<li><a name="a70"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc"> phpHaml</span></li>
<li><a name="a71"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@subpackage</span><span class="src-doc"> Haml</span></li>
<li><a name="a72"></a><span class="src-doc"> */</span></li>
<li><a name="a73"></a><span class="src-key">class </span><a href="../phpHaml/Haml/HamlParser.html">HamlParser</a></li>
<li><a name="a74"></a><span class="src-sym">{</span></li>
<li><a name="a75"></a>    <span class="src-doc">/**</span></li>
<li><a name="a76"></a><span class="src-doc">     * Haml source</span></li>
<li><a name="a77"></a><span class="src-doc">     *</span></li>
<li><a name="a78"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a79"></a><span class="src-doc">     */</span></li>
<li><a name="a80"></a>    <span class="src-key">public </span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">$sSource</a> = <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a81"></a>&nbsp;</li>
<li><a name="a82"></a>    <span class="src-doc">/**</span></li>
<li><a name="a83"></a><span class="src-doc">     * Files path</span></li>
<li><a name="a84"></a><span class="src-doc">     *</span></li>
<li><a name="a85"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a86"></a><span class="src-doc">     */</span></li>
<li><a name="a87"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$sPath">$sPath</a> = <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a88"></a>&nbsp;</li>
<li><a name="a89"></a>    <span class="src-doc">/**</span></li>
<li><a name="a90"></a><span class="src-doc">     * Compile templates??</span></li>
<li><a name="a91"></a><span class="src-doc">     *</span></li>
<li><a name="a92"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">boolean </span></li>
<li><a name="a93"></a><span class="src-doc">     */</span></li>
<li><a name="a94"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$bCompile">$bCompile</a> = <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a95"></a>&nbsp;</li>
<li><a name="a96"></a>    <span class="src-doc">/**</span></li>
<li><a name="a97"></a><span class="src-doc">     * Filename</span></li>
<li><a name="a98"></a><span class="src-doc">     *</span></li>
<li><a name="a99"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a100"></a><span class="src-doc">     */</span></li>
<li><a name="a101"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">$sFile</a> = <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a102"></a>&nbsp;</li>
<li><a name="a103"></a>    <span class="src-doc">/**</span></li>
<li><a name="a104"></a><span class="src-doc">     * Parent parser</span></li>
<li><a name="a105"></a><span class="src-doc">     *</span></li>
<li><a name="a106"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">object </span></li>
<li><a name="a107"></a><span class="src-doc">     */</span></li>
<li><a name="a108"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">$oParent</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a109"></a>&nbsp;</li>
<li><a name="a110"></a>    <span class="src-doc">/**</span></li>
<li><a name="a111"></a><span class="src-doc">     * Children parsers</span></li>
<li><a name="a112"></a><span class="src-doc">     *</span></li>
<li><a name="a113"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a114"></a><span class="src-doc">     */</span></li>
<li><a name="a115"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">$aChildren</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a116"></a>&nbsp;</li>
<li><a name="a117"></a>    <span class="src-doc">/**</span></li>
<li><a name="a118"></a><span class="src-doc">     * Indent level</span></li>
<li><a name="a119"></a><span class="src-doc">     *</span></li>
<li><a name="a120"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">integer </span></li>
<li><a name="a121"></a><span class="src-doc">     */</span></li>
<li><a name="a122"></a>    <span class="src-key">public </span><a href="../phpHaml/Haml/HamlParser.html#var$iIndent">$iIndent</a> = -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a123"></a>&nbsp;</li>
<li><a name="a124"></a>    <span class="src-doc">/**</span></li>
<li><a name="a125"></a><span class="src-doc">     * Translation function name.</span></li>
<li><a name="a126"></a><span class="src-doc">     *</span></li>
<li><a name="a127"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a128"></a><span class="src-doc">     */</span></li>
<li><a name="a129"></a>    <span class="src-key">public </span><a href="../phpHaml/Haml/HamlParser.html#var$sTranslate">$sTranslate</a> = <span class="src-str">'fake_translate'</span><span class="src-sym">;</span></li>
<li><a name="a130"></a>&nbsp;</li>
<li><a name="a131"></a>    <span class="src-doc">/**</span></li>
<li><a name="a132"></a><span class="src-doc">     * Translation function</span></li>
<li><a name="a133"></a><span class="src-doc">     *</span></li>
<li><a name="a134"></a><span class="src-doc">     * You can use it in templates.</span></li>
<li><a name="a135"></a><span class="src-doc">     * &lt;code&gt;</span></li>
<li><a name="a136"></a><span class="src-doc">     * %strong= $foo.$this-&gt;translate('to translate')</span></li>
<li><a name="a137"></a><span class="src-doc">     * &lt;/code&gt;</span></li>
<li><a name="a138"></a><span class="src-doc">     */</span></li>
<li><a name="a139"></a>    <span class="src-key">protected </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodtranslate">translate</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a140"></a>    <span class="src-sym">{</span></li>
<li><a name="a141"></a>        <span class="src-var">$a </span>= <a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a142"></a>        <span class="src-key">return </span><a href="http://www.php.net/call_user_func_array">call_user_func_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTranslate">sTranslate</a><span class="src-sym">, </span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a143"></a>    <span class="src-sym">}</span></li>
<li><a name="a144"></a>&nbsp;</li>
<li><a name="a145"></a>    <span class="src-doc">/**</span></li>
<li><a name="a146"></a><span class="src-doc">     * Temporary directory</span></li>
<li><a name="a147"></a><span class="src-doc">     *</span></li>
<li><a name="a148"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a149"></a><span class="src-doc">     */</span></li>
<li><a name="a150"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$sTmp">$sTmp</a> = <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a151"></a>&nbsp;</li>
<li><a name="a152"></a>    <span class="src-doc">/**</span></li>
<li><a name="a153"></a><span class="src-doc">     * Block of PHP code</span></li>
<li><a name="a154"></a><span class="src-doc">     *</span></li>
<li><a name="a155"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">boolean </span></li>
<li><a name="a156"></a><span class="src-doc">     */</span></li>
<li><a name="a157"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$bBlock">$bBlock</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a158"></a>&nbsp;</li>
<li><a name="a159"></a>    <span class="src-doc">/**</span></li>
<li><a name="a160"></a><span class="src-doc">     * Current tag name</span></li>
<li><a name="a161"></a><span class="src-doc">     *</span></li>
<li><a name="a162"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a163"></a><span class="src-doc">     */</span></li>
<li><a name="a164"></a>    <span class="src-key">public </span><a href="../phpHaml/Haml/HamlParser.html#var$sTag">$sTag</a> = <span class="src-str">'div'</span><span class="src-sym">;</span></li>
<li><a name="a165"></a>&nbsp;</li>
<li><a name="a166"></a>    <span class="src-doc">/**</span></li>
<li><a name="a167"></a><span class="src-doc">     * The constructor.</span></li>
<li><a name="a168"></a><span class="src-doc">     *</span></li>
<li><a name="a169"></a><span class="src-doc">     * Create Haml parser. Second argument can be path to</span></li>
<li><a name="a170"></a><span class="src-doc">     * temporary directory or boolean if true then templates</span></li>
<li><a name="a171"></a><span class="src-doc">     * are compiled to templates path else if false then</span></li>
<li><a name="a172"></a><span class="src-doc">     * templates are compiled on every run</span></li>
<li><a name="a173"></a><span class="src-doc">     * &lt;code&gt;</span></li>
<li><a name="a174"></a><span class="src-doc">     * &lt;?php</span></li>
<li><a name="a175"></a><span class="src-doc">     * require_once './includes/haml/HamlParser.class.php';</span></li>
<li><a name="a176"></a><span class="src-doc">     *</span></li>
<li><a name="a177"></a><span class="src-doc">     * $parser = new HamlParser('./tpl', './tmp');</span></li>
<li><a name="a178"></a><span class="src-doc">     * $foo = 'bar';</span></li>
<li><a name="a179"></a><span class="src-doc">     * $parser-&gt;assign('foo', $foo);</span></li>
<li><a name="a180"></a><span class="src-doc">     * $parser-&gt;display('mainpage.haml');</span></li>
<li><a name="a181"></a><span class="src-doc">     * ?&gt;</span></li>
<li><a name="a182"></a><span class="src-doc">     * &lt;/code&gt;</span></li>
<li><a name="a183"></a><span class="src-doc">     *</span></li>
<li><a name="a184"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">Path to files</span></li>
<li><a name="a185"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">boolean/string </span><span class="src-doc">Compile templates (can be path)</span></li>
<li><a name="a186"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">object </span><span class="src-doc-type">Parent </span><span class="src-doc">parser</span></li>
<li><a name="a187"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">array </span><span class="src-doc">Array with debug informations</span></li>
<li><a name="a188"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">boolean </span><span class="src-doc">Is used dynamic including</span></li>
<li><a name="a189"></a><span class="src-doc">     */</span></li>
<li><a name="a190"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#method__construct">__construct</a><span class="src-sym">(</span><span class="src-var">$sPath </span>= <span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$bCompile </span>= <span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$oParent </span>= <span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$aDebug </span>= <span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$bInside </span>= <span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a191"></a>    <span class="src-sym">{</span></li>
<li><a name="a192"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span></li>
<li><a name="a193"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetPath">setPath</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a194"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bCompile">bCompile</a> = <span class="src-var">$bCompile</span><span class="src-sym">;</span></li>
<li><a name="a195"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$bCompile</span><span class="src-sym">))</span></li>
<li><a name="a196"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetTmp">setTmp</a><span class="src-sym">(</span><span class="src-var">$bCompile</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-key">else</span></li>
<li><a name="a197"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span></li>
<li><a name="a198"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetTmp">setTmp</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a199"></a>        <span class="src-key">else</span></li>
<li><a name="a200"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetTmp">setTmp</a><span class="src-sym">(</span><a href="http://www.php.net/ini_get">ini_get</a><span class="src-sym">(</span><span class="src-str">'session.save_path'</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a201"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$oParent</span><span class="src-sym">)</span></li>
<li><a name="a202"></a>        <span class="src-sym">{</span></li>
<li><a name="a203"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetParent">setParent</a><span class="src-sym">(</span><span class="src-var">$oParent</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a204"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aDebug</span><span class="src-sym">)</span></li>
<li><a name="a205"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aDebug">aDebug</a> = <span class="src-var">$aDebug</span><span class="src-sym">;</span></li>
<li><a name="a206"></a>        <span class="src-sym">}</span></li>
<li><a name="a207"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bInside">bInside</a> = <span class="src-var">$bInside</span><span class="src-sym">;</span></li>
<li><a name="a208"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$otc</span><span class="src-sym">)</span></li>
<li><a name="a209"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">__otc</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a210"></a>    <span class="src-sym">}</span></li>
<li><a name="a211"></a>    </li>
<li><a name="a212"></a>    <span class="src-doc">/**</span></li>
<li><a name="a213"></a><span class="src-doc">     * Is used dynamic including</span></li>
<li><a name="a214"></a><span class="src-doc">     *</span></li>
<li><a name="a215"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">boolean </span></li>
<li><a name="a216"></a><span class="src-doc">     */</span></li>
<li><a name="a217"></a>    <span class="src-key">protected </span><a href="../phpHaml/Haml/HamlParser.html#var$bInside">$bInside</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a218"></a>    </li>
<li><a name="a219"></a>    <span class="src-doc">/**</span></li>
<li><a name="a220"></a><span class="src-doc">     * Debugging informations</span></li>
<li><a name="a221"></a><span class="src-doc">     *</span></li>
<li><a name="a222"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a223"></a><span class="src-doc">     */</span></li>
<li><a name="a224"></a>    <span class="src-key">public </span><a href="../phpHaml/Haml/HamlParser.html#var$aDebug">$aDebug</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a225"></a>&nbsp;</li>
<li><a name="a226"></a>    <span class="src-doc">/**</span></li>
<li><a name="a227"></a><span class="src-doc">     * Render Haml. Append globals variables</span></li>
<li><a name="a228"></a><span class="src-doc">     *</span></li>
<li><a name="a229"></a><span class="src-doc">     * Simple way to use Haml</span></li>
<li><a name="a230"></a><span class="src-doc">     * &lt;code&gt;</span></li>
<li><a name="a231"></a><span class="src-doc">     * echo HamlParser::haml('%strong Hello, World!'); // &lt;strong&gt;Hello, World!&lt;/strong&gt;</span></li>
<li><a name="a232"></a><span class="src-doc">     * $foo = 'bar'; // This is global variable</span></li>
<li><a name="a233"></a><span class="src-doc">     * echo Haml::haml('%strong= &quot;Foo is $foo&quot;'); // &lt;strong&gt;Foo is bar&lt;/strong&gt;</span></li>
<li><a name="a234"></a><span class="src-doc">     * &lt;/code&gt;</span></li>
<li><a name="a235"></a><span class="src-doc">     *</span></li>
<li><a name="a236"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">Haml source</span></li>
<li><a name="a237"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">xHTML</span></li>
<li><a name="a238"></a><span class="src-doc">     */</span></li>
<li><a name="a239"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodhaml">haml</a><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">)</span></li>
<li><a name="a240"></a>    <span class="src-sym">{</span></li>
<li><a name="a241"></a>        <span class="src-key">static </span><span class="src-var">$__haml_parser</span><span class="src-sym">;</span></li>
<li><a name="a242"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$__haml_parser</span><span class="src-sym">)</span></li>
<li><a name="a243"></a>            <span class="src-var">$__haml_parser </span>= <span class="src-key">new </span><span class="src-id"><a href="../phpHaml/Haml/HamlParser.html">HamlParser</a></span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a244"></a>        <span class="src-var">$__haml_parser</span><span class="src-sym">-&gt;</span><span class="src-id">setSource</span><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a245"></a>        <span class="src-var">$__haml_parser</span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$GLOBALS</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a246"></a>        <span class="src-key">return </span><span class="src-var">$__haml_parser</span><span class="src-sym">-&gt;</span><span class="src-id">fetch</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a247"></a>    <span class="src-sym">}</span></li>
<li><a name="a248"></a>&nbsp;</li>
<li><a name="a249"></a>    <span class="src-doc">/**</span></li>
<li><a name="a250"></a><span class="src-doc">     * One time constructor, is executed??</span></li>
<li><a name="a251"></a><span class="src-doc">     *</span></li>
<li><a name="a252"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">boolean </span></li>
<li><a name="a253"></a><span class="src-doc">     */</span></li>
<li><a name="a254"></a>    <span class="src-key">protected </span><span class="src-key">static </span><span class="src-var">$otc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a255"></a>&nbsp;</li>
<li><a name="a256"></a>    <span class="src-doc">/**</span></li>
<li><a name="a257"></a><span class="src-doc">     * One time constructor. Register Textile block</span></li>
<li><a name="a258"></a><span class="src-doc">     * if exists Textile class and Markdown block if</span></li>
<li><a name="a259"></a><span class="src-doc">     * exists Markdown functions</span></li>
<li><a name="a260"></a><span class="src-doc">     */</span></li>
<li><a name="a261"></a>    <span class="src-key">protected </span><span class="src-key">static </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#method__otc">__otc</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a262"></a>    <span class="src-sym">{</span></li>
<li><a name="a263"></a>        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$otc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a264"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/class_exists">class_exists</a><span class="src-sym">(</span><span class="src-str">'Textile'</span><span class="src-sym">, </span><span class="src-id">false</span><span class="src-sym">))</span></li>
<li><a name="a265"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">registerBlock</span><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-key">new </span><span class="src-id">Textile</span><span class="src-sym">, </span><span class="src-str">'TextileThis'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-str">'textile'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a266"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/function_exists">function_exists</a><span class="src-sym">(</span><span class="src-str">'Markdown'</span><span class="src-sym">))</span></li>
<li><a name="a267"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">registerBlock</span><span class="src-sym">(</span><span class="src-str">'Markdown'</span><span class="src-sym">, </span><span class="src-str">'markdown'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a268"></a>        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">tryRegisterSass</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a269"></a>    <span class="src-sym">}</span></li>
<li><a name="a270"></a>&nbsp;</li>
<li><a name="a271"></a>    <span class="src-doc">/**</span></li>
<li><a name="a272"></a><span class="src-doc">     * Try register Sass engine as text block</span></li>
<li><a name="a273"></a><span class="src-doc">     *</span></li>
<li><a name="a274"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">boolean </span></li>
<li><a name="a275"></a><span class="src-doc">     */</span></li>
<li><a name="a276"></a>    <span class="src-key">protected </span><span class="src-key">static </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodtryRegisterSass">tryRegisterSass</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a277"></a>    <span class="src-sym">{</span></li>
<li><a name="a278"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$f </span>= <a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span>__FILE__<span class="src-sym">) </span>. <span class="src-str">'/../sass/SassParser.class.php'</span><span class="src-sym">))</span></li>
<li><a name="a279"></a>            <span class="src-inc">require_once </span><span class="src-var">$f</span><span class="src-sym">;</span></li>
<li><a name="a280"></a>        <span class="src-key">else</span></li>
<li><a name="a281"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a282"></a>        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">registerBlock</span><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'SassParser'</span><span class="src-sym">, </span><span class="src-str">'sass'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-str">'sass'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a283"></a>        <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a284"></a>    <span class="src-sym">}</span></li>
<li><a name="a285"></a>&nbsp;</li>
<li><a name="a286"></a>    <span class="src-doc">/**</span></li>
<li><a name="a287"></a><span class="src-doc">     * Set parent parser. Used internally.</span></li>
<li><a name="a288"></a><span class="src-doc">     *</span></li>
<li><a name="a289"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">object </span><span class="src-doc-type">Parent </span><span class="src-doc">parser</span></li>
<li><a name="a290"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">object </span></li>
<li><a name="a291"></a><span class="src-doc">     */</span></li>
<li><a name="a292"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodsetParent">setParent</a><span class="src-sym">(</span><span class="src-id">HamlParser </span><span class="src-var">$oParent</span><span class="src-sym">)</span></li>
<li><a name="a293"></a>    <span class="src-sym">{</span></li>
<li><a name="a294"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a> = <span class="src-var">$oParent</span><span class="src-sym">;</span></li>
<li><a name="a295"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a> = <span class="src-var">$oParent</span><span class="src-sym">-&gt;</span><span class="src-id">bRemoveBlank</span><span class="src-sym">;</span></li>
<li><a name="a296"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a297"></a>    <span class="src-sym">}</span></li>
<li><a name="a298"></a>&nbsp;</li>
<li><a name="a299"></a>    <span class="src-doc">/**</span></li>
<li><a name="a300"></a><span class="src-doc">     * Set files path.</span></li>
<li><a name="a301"></a><span class="src-doc">     *</span></li>
<li><a name="a302"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">File path</span></li>
<li><a name="a303"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">object </span></li>
<li><a name="a304"></a><span class="src-doc">     */</span></li>
<li><a name="a305"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodsetPath">setPath</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span></li>
<li><a name="a306"></a>    <span class="src-sym">{</span></li>
<li><a name="a307"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sPath">sPath</a> = <a href="http://www.php.net/realpath">realpath</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a308"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a309"></a>    <span class="src-sym">}</span></li>
<li><a name="a310"></a>&nbsp;</li>
<li><a name="a311"></a>    <span class="src-doc">/**</span></li>
<li><a name="a312"></a><span class="src-doc">     * Set filename.</span></li>
<li><a name="a313"></a><span class="src-doc">     *</span></li>
<li><a name="a314"></a><span class="src-doc">     * Filename can be full path to file or</span></li>
<li><a name="a315"></a><span class="src-doc">     * filename (then file is searched in path)</span></li>
<li><a name="a316"></a><span class="src-doc">     * &lt;code&gt;</span></li>
<li><a name="a317"></a><span class="src-doc">     * // We have file ./foo.haml and ./tpl/bar.haml</span></li>
<li><a name="a318"></a><span class="src-doc">     * // ...</span></li>
<li><a name="a319"></a><span class="src-doc">     * $parser-&gt;setPath('./tpl');</span></li>
<li><a name="a320"></a><span class="src-doc">     * $parser-&gt;setFile('foo.haml'); // Setted to ./foo.haml</span></li>
<li><a name="a321"></a><span class="src-doc">     * $parser-&gt;setFile('bar.haml'); // Setted to ./tpl/bar.haml</span></li>
<li><a name="a322"></a><span class="src-doc">     * &lt;/code&gt;</span></li>
<li><a name="a323"></a><span class="src-doc">     *</span></li>
<li><a name="a324"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">Filename</span></li>
<li><a name="a325"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">object </span></li>
<li><a name="a326"></a><span class="src-doc">     */</span></li>
<li><a name="a327"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../phpHaml/Haml/HamlParser.html#methodsetFile">setFile</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span></li>
<li><a name="a328"></a>    <span class="src-sym">{</span></li>
<li><a name="a329"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">))</span></li>
<li><a name="a330"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">sFile</a> = <span class="src-var">$sPath</span><span class="src-sym">;</span></li>
<li><a name="a331"></a>        <span class="src-key">else</span></li>
<li><a name="a332"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">sFile</a> = <span class="src-str">&quot;</span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sPath">sPath</a><span class="src-sym">}</span>/<span class="src-var">$sPath<span class="src-str"></span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a333"></a><span class="src-str">        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetSource">setSource</a><span class="src-sym">(</span><span class="src-id">file_get_contents</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">sFile</a><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a334"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a335"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a336"></a>&nbsp;</li>
<li><a name="a337"></a><span class="src-str">    /**</span></li>
<li><a name="a338"></a><span class="src-str">     * Return filename to include</span></li>
<li><a name="a339"></a><span class="src-str">     *</span></li>
<li><a name="a340"></a><span class="src-str">     * You can override this function.</span></li>
<li><a name="a341"></a><span class="src-str">     *</span></li>
<li><a name="a342"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a343"></a><span class="src-str">     * @return string</span></li>
<li><a name="a344"></a><span class="src-str">     */</span></li>
<li><a name="a345"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">getFilename</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">)</span></span></li>
<li><a name="a346"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a347"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sPath">sPath</a><span class="src-sym">}</span>/<span class="src-str"><span class="src-str">"</span>.<span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">)</span>.<span class="src-str">'.haml'</span><span class="src-sym">;</span></span></li>
<li><a name="a348"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a349"></a>&nbsp;</li>
<li><a name="a350"></a><span class="src-str">    /**</span></li>
<li><a name="a351"></a><span class="src-str">     * Real source</span></li>
<li><a name="a352"></a><span class="src-str">     *</span></li>
<li><a name="a353"></a><span class="src-str">     * @var string</span></li>
<li><a name="a354"></a><span class="src-str">     */</span></li>
<li><a name="a355"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-var">$sRealSource</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a356"></a>&nbsp;</li>
<li><a name="a357"></a><span class="src-str">    /**</span></li>
<li><a name="a358"></a><span class="src-str">     * Set source code</span></li>
<li><a name="a359"></a><span class="src-str">     *</span></li>
<li><a name="a360"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a361"></a><span class="src-str">     * // ...</span></li>
<li><a name="a362"></a><span class="src-str">     * $parser-&gt;setFile('foo.haml');</span></li>
<li><a name="a363"></a><span class="src-str">     * echo $parser-&gt;setSource('%strong Foo')-&gt;fetch(); // &lt;strong&gt;Foo&lt;/strong&gt;</span></li>
<li><a name="a364"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a365"></a><span class="src-str">     *</span></li>
<li><a name="a366"></a><span class="src-str">     * @param string Source</span></li>
<li><a name="a367"></a><span class="src-str">     * @return object</span></li>
<li><a name="a368"></a><span class="src-str">     */</span></li>
<li><a name="a369"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">setSource</span><span class="src-sym">(</span><span class="src-var">$sHaml</span><span class="src-sym">)</span></span></li>
<li><a name="a370"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a371"></a><span class="src-str">        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$sHaml</span><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INDENT</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a372"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sRealSource">sRealSource</a> = <span class="src-var">$sHaml</span><span class="src-sym">;</span></li>
<li><a name="a373"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a374"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a375"></a>&nbsp;</li>
<li><a name="a376"></a>&nbsp;</li>
<li><a name="a377"></a><span class="src-str">    /**</span></li>
<li><a name="a378"></a><span class="src-str">     * Set temporary directory</span></li>
<li><a name="a379"></a><span class="src-str">     *</span></li>
<li><a name="a380"></a><span class="src-str">     * @param string Directory</span></li>
<li><a name="a381"></a><span class="src-str">     * @return object</span></li>
<li><a name="a382"></a><span class="src-str">     */</span></li>
<li><a name="a383"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">setTmp</span><span class="src-sym">(</span><span class="src-var">$sTmp</span><span class="src-sym">)</span></span></li>
<li><a name="a384"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a385"></a><span class="src-str">        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTmp">sTmp</a> = <span class="src-id">realpath</span><span class="src-sym">(</span><span class="src-var">$sTmp</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a386"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a387"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a388"></a><span class="src-str">    </span></li>
<li><a name="a389"></a><span class="src-str">    /**</span></li>
<li><a name="a390"></a><span class="src-str">     * Debug mode</span></li>
<li><a name="a391"></a><span class="src-str">     *</span></li>
<li><a name="a392"></a><span class="src-str">     * @see HamlParser::isDebug()</span></li>
<li><a name="a393"></a><span class="src-str">     * @var boolean</span></li>
<li><a name="a394"></a><span class="src-str">     */</span></li>
<li><a name="a395"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$bDebug</span> = <span class="src-id">false</span><span class="src-sym">;</span></span></li>
<li><a name="a396"></a><span class="src-str">    </span></li>
<li><a name="a397"></a><span class="src-str">    /**</span></li>
<li><a name="a398"></a><span class="src-str">     * Set and check debug mode. If is set</span></li>
<li><a name="a399"></a><span class="src-str">     * debugging mode to generated source are</span></li>
<li><a name="a400"></a><span class="src-str">     * added comments with debugging mode and </span></li>
<li><a name="a401"></a><span class="src-str">     * Haml source is not cached.</span></li>
<li><a name="a402"></a><span class="src-str">     *</span></li>
<li><a name="a403"></a><span class="src-str">     * @param boolean Debugging mode (if null, then only return current state)</span></li>
<li><a name="a404"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a405"></a><span class="src-str">     */</span></li>
<li><a name="a406"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">isDebug</span><span class="src-sym">(</span><span class="src-var">$bDebug</span> = <span class="src-id">null</span><span class="src-sym">)</span></span></li>
<li><a name="a407"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a408"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$bDebug</span><span class="src-sym">))</span></span></li>
<li><a name="a409"></a><span class="src-str">            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$bDebug</span> = <span class="src-var">$bDebug</span><span class="src-sym">;</span></span></li>
<li><a name="a410"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$bDebug</span><span class="src-sym">)</span></span></li>
<li><a name="a411"></a><span class="src-str">            <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bCompile">bCompile</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a412"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$bDebug</span><span class="src-sym">;</span></li>
<li><a name="a413"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a414"></a>&nbsp;</li>
<li><a name="a415"></a><span class="src-str">    /**</span></li>
<li><a name="a416"></a><span class="src-str">     * Render the source or file</span></li>
<li><a name="a417"></a><span class="src-str">     *</span></li>
<li><a name="a418"></a><span class="src-str">     * @see HamlParser::fetch()</span></li>
<li><a name="a419"></a><span class="src-str">     * @return string</span></li>
<li><a name="a420"></a><span class="src-str">     */</span></li>
<li><a name="a421"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">render</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a422"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a423"></a><span class="src-str">        <span class="src-var">$__aSource</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">,</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sRealSource">sRealSource</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodparseBreak">parseBreak</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a424"></a>        <span class="src-var">$__sCompiled </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a425"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a> instanceof <span class="src-id">HamlParser</span><span class="src-sym">)</span></li>
<li><a name="a426"></a>            <span class="src-var">$__sCompiled </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodparseLine">parseLine</a><span class="src-sym">(</span><span class="src-var">$__aSource</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a427"></a>        <span class="src-key">else</span></li>
<li><a name="a428"></a>        <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a429"></a><span class="src-str">            <span class="src-var">$__oCache</span> = <span class="src-key">new</span> <span class="src-id">CommonCache</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTmp">sTmp</a><span class="src-sym">, </span><span class="src-str">'hphp'</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a430"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$__oCache</span><span class="src-sym">-&gt;</span><span class="src-id">isCached</span><span class="src-sym">(</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bCompile">bCompile</a> &amp;&amp; <span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a431"></a>                <span class="src-var">$__sCompiled </span>= <span class="src-var">$__oCache</span><span class="src-sym">-&gt;</span><span class="src-id">getFilename</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a432"></a>            <span class="src-key">else</span></li>
<li><a name="a433"></a>            <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a434"></a><span class="src-str">                <span class="src-var">$__sGenSource</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a><span class="src-sym">;</span></li>
<li><a name="a435"></a>                do</li>
<li><a name="a436"></a>                <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a437"></a><span class="src-str">                    <span class="src-var">$__iIndent</span> = <span class="src-num">0</span><span class="src-sym">;</span></span></li>
<li><a name="a438"></a><span class="src-str">                    <span class="src-var">$__iIndentLevel</span> = <span class="src-num">0</span><span class="src-sym">;</span></span></li>
<li><a name="a439"></a><span class="src-str">                    <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$__aSource</span> <span class="src-key">as</span> <span class="src-var">$__iKey</span> =&gt; <span class="src-var">$__sLine</span><span class="src-sym">)</span></span></li>
<li><a name="a440"></a><span class="src-str">                    <span class="src-sym">{</span></span></li>
<li><a name="a441"></a><span class="src-str">                        <span class="src-var">$__iLevel</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcountLevel">countLevel</a><span class="src-sym">(</span><span class="src-var">$__sLine</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a442"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$__iLevel </span>&lt;= <span class="src-var">$__iIndentLevel</span><span class="src-sym">)</span></li>
<li><a name="a443"></a>                        <span class="src-var">$__iIndent </span>= <span class="src-var">$__iIndentLevel </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a444"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LEVEL</span>.<span class="src-str">'([0-9]+)$/'</span><span class="src-sym">, </span><span class="src-var">$__sLine</span><span class="src-sym">, </span><span class="src-var">$__aMatches</span><span class="src-sym">))</span></li>
<li><a name="a445"></a>                        <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a446"></a><span class="src-str">                            <span class="src-var">$__iIndent</span> = (int)<span class="src-var">$__aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a447"></a><span class="src-str">                            <span class="src-var">$__iIndentLevel</span> = <span class="src-var">$__iLevel</span><span class="src-sym">;</span></span></li>
<li><a name="a448"></a><span class="src-str">                            <span class="src-var">$__sLine</span> = <span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LEVEL</span>.<span class="src-str">"</span><span class="src-var">$__iIndent</span>$/<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-str">''</span><span class="src-sym">,</span> <span class="src-var">$__sLine</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a449"></a><span class="src-str">                        <span class="src-sym">}</span></span></li>
<li><a name="a450"></a><span class="src-str">                        <span class="src-var">$__sLine</span> = <span class="src-id">str_repeat</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INDENT</span><span class="src-sym">,</span> <span class="src-var">$__iIndent</span> * <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">INDENT</span><span class="src-sym">)</span> . <span class="src-var">$__sLine</span><span class="src-sym">;</span></span></li>
<li><a name="a451"></a><span class="src-str">                        <span class="src-var">$__aSource</span><span class="src-sym">[</span><span class="src-var">$__iKey</span><span class="src-sym">]</span> = <span class="src-var">$__sLine</span><span class="src-sym">;</span></span></li>
<li><a name="a452"></a><span class="src-str">                        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^(\s*)'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INCLUDE</span>.<span class="src-str">' (.+)/'</span><span class="src-sym">,</span> <span class="src-var">$__sLine</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a453"></a><span class="src-str">                        <span class="src-sym">{</span></span></li>
<li><a name="a454"></a><span class="src-str">                            <span class="src-var">$__sISource</span> = <span class="src-id">file_get_contents</span><span class="src-sym">(</span><span class="src-var">$__sIFile</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodgetFilename">getFilename</a><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a455"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a456"></a>                                <span class="src-var">$__sISource </span>= <span class="src-str"><span class="src-str">"</span>// <span class="src-id">Begin</span> <span class="src-id">file</span> <span class="src-var">$__sIFile</span>\n<span class="src-var">$__sISource</span>\n// <span class="src-id">End</span> <span class="src-id">file</span> <span class="src-var">$__sIFile</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a457"></a><span class="src-str">                            <span class="src-var">$__sIncludeSource</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsourceIndent">sourceIndent</a><span class="src-sym">(</span><span class="src-var">$__sISource</span><span class="src-sym">, </span><span class="src-var">$__iIndent </span>? <span class="src-var">$__iIndent </span>: <span class="src-var">$__iLevel</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a458"></a>                            <span class="src-var">$__sLine </span>= <span class="src-id">str_replace</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>. <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INCLUDE </span>. <span class="src-str"><span class="src-str">"</span> </span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span><span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$__sIncludeSource</span><span class="src-sym">,</span> <span class="src-var">$__sLine</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a459"></a><span class="src-str">                            <span class="src-var">$__aSource</span><span class="src-sym">[</span><span class="src-var">$__iKey</span><span class="src-sym">]</span> = <span class="src-var">$__sLine</span><span class="src-sym">;</span></span></li>
<li><a name="a460"></a><span class="src-str">                        <span class="src-sym">}</span></span></li>
<li><a name="a461"></a><span class="src-str">                        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a> = <span class="src-id">implode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">, </span><span class="src-var">$__aSource</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a462"></a>                    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a463"></a><span class="src-str">                    <span class="src-var">$__aSource</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">,</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a> = <span class="src-var">$__sGenSource </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodparseBreak">parseBreak</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a464"></a>                <span class="src-str"><span class="src-sym">}</span> <span class="src-key">while</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/(\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LEVEL</span>.<span class="src-str">'[0-9]+)|(\s*[^!]'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INCLUDE</span>.<span class="src-str">' .+)/'</span><span class="src-sym">,</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a465"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sSource">sSource</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sRealSource">sRealSource</a><span class="src-sym">;</span></li>
<li><a name="a466"></a>                <span class="src-var">$__sCompiled </span>= <span class="src-var">$__oCache</span><span class="src-sym">-&gt;</span><span class="src-id">setCached</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodparseFile">parseFile</a><span class="src-sym">(</span><span class="src-var">$__aSource</span><span class="src-sym">))</span><span class="src-sym">-&gt;</span><span class="src-id">cacheIt</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">-&gt;</span><span class="src-id">getFilename</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a467"></a>            <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a468"></a><span class="src-str">            <span class="src-comm">// Expand compiled template</span></span></li>
<li><a name="a469"></a><span class="src-str">            <span class="src-comm">// set up variables for context</span></span></li>
<li><a name="a470"></a><span class="src-str">            <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span> <span class="src-key">as</span> <span class="src-var">$__sName</span> =&gt; <span class="src-var">$__mValue</span><span class="src-sym">)</span></span></li>
<li><a name="a471"></a><span class="src-str">                $<span class="src-var">$__sName</span> = <span class="src-var">$__mValue</span><span class="src-sym">;</span></span></li>
<li><a name="a472"></a><span class="src-str">            <span class="src-id">ob_start</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span>        <span class="src-comm">// start a new output buffer</span></span></li>
<li><a name="a473"></a><span class="src-str">            require <span class="src-var">$__sCompiled</span><span class="src-sym">;</span></span></li>
<li><a name="a474"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a475"></a>                <span class="src-sym">@</span><span class="src-id">unlink</span><span class="src-sym">(</span><span class="src-var">$__sCompiled</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a476"></a>            <span class="src-var">$__c </span>= <span class="src-id">rtrim</span><span class="src-sym">(</span><span class="src-id">ob_get_clean</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">; </span><span class="src-comm">// capture the result, and discard ob</span></li>
<li><a name="a477"></a>            <span class="src-comm">// Call filters</span></li>
<li><a name="a478"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aFilters">aFilters</a> <span class="src-key">as </span><span class="src-var">$mFilter</span><span class="src-sym">)</span></li>
<li><a name="a479"></a>                <span class="src-var">$__c </span>= <span class="src-id">call_user_func</span><span class="src-sym">(</span><span class="src-var">$mFilter</span><span class="src-sym">, </span><span class="src-var">$__c</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a480"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a481"></a>            <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a482"></a><span class="src-str">                <span class="src-id">header</span><span class="src-sym">(</span><span class="src-str">'Content-Type: text/plain'</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a483"></a><span class="src-str">                <span class="src-var">$__a</span> = <span class="src-str">"</span>\n<span class="src-id">File</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">sFile</a>:\n<span class="src-str"><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a484"></a><span class="src-str">                <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,</span> <span class="src-var">$__sGenSource</span><span class="src-sym">)</span> <span class="src-key">as</span> <span class="src-var">$iKey</span> =&gt; <span class="src-var">$sLine</span><span class="src-sym">)</span></span></li>
<li><a name="a485"></a><span class="src-str">                    <span class="src-var">$__a</span> .= <span class="src-str">'F'</span> . <span class="src-sym">(</span><span class="src-var">$iKey</span> + <span class="src-num">1</span><span class="src-sym">)</span> . <span class="src-str">"</span>:\t<span class="src-var">$sLine</span>\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a486"></a><span class="src-str">                <span class="src-var">$__c</span> .= <span class="src-id">rtrim</span><span class="src-sym">(</span><span class="src-var">$__a</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a487"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a488"></a><span class="src-str">            <span class="src-key">return</span> <span class="src-var">$__c</span><span class="src-sym">;</span></span></li>
<li><a name="a489"></a><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a490"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$__sCompiled</span><span class="src-sym">;</span></span></li>
<li><a name="a491"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a492"></a>&nbsp;</li>
<li><a name="a493"></a><span class="src-str">    /**</span></li>
<li><a name="a494"></a><span class="src-str">     * Render the source or file</span></li>
<li><a name="a495"></a><span class="src-str">     *</span></li>
<li><a name="a496"></a><span class="src-str">     * @see HamlParser::fetch()</span></li>
<li><a name="a497"></a><span class="src-str">     * @return string</span></li>
<li><a name="a498"></a><span class="src-str">     */</span></li>
<li><a name="a499"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">__toString</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a500"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a501"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodrender">render</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a502"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a503"></a>&nbsp;</li>
<li><a name="a504"></a><span class="src-str">    /**</span></li>
<li><a name="a505"></a><span class="src-str">     * Parse multiline</span></li>
<li><a name="a506"></a><span class="src-str">     *</span></li>
<li><a name="a507"></a><span class="src-str">     * @param string File content</span></li>
<li><a name="a508"></a><span class="src-str">     * @return string</span></li>
<li><a name="a509"></a><span class="src-str">     */</span></li>
<li><a name="a510"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">parseBreak</span><span class="src-sym">(</span><span class="src-var">$sFile</span><span class="src-sym">)</span></span></li>
<li><a name="a511"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a512"></a><span class="src-str">        <span class="src-var">$sFile</span> = <span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_BREAK</span>.<span class="src-str">'\s*/'</span><span class="src-sym">,</span> <span class="src-str">''</span><span class="src-sym">,</span> <span class="src-var">$sFile</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a513"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$sFile</span><span class="src-sym">;</span></span></li>
<li><a name="a514"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a515"></a>&nbsp;</li>
<li><a name="a516"></a><span class="src-str">    /**</span></li>
<li><a name="a517"></a><span class="src-str">     * Return source of child</span></li>
<li><a name="a518"></a><span class="src-str">     *</span></li>
<li><a name="a519"></a><span class="src-str">     * @param integer Level</span></li>
<li><a name="a520"></a><span class="src-str">     * @return string</span></li>
<li><a name="a521"></a><span class="src-str">     */</span></li>
<li><a name="a522"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">getAsSource</span><span class="src-sym">(</span><span class="src-var">$iLevel</span><span class="src-sym">)</span></span></li>
<li><a name="a523"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a524"></a><span class="src-str">        <span class="src-var">$x</span> = <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$iIndent">iIndent</a> - <span class="src-var">$iLevel </span>- <span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">INDENT</span><span class="src-sym">;</span></li>
<li><a name="a525"></a>        <span class="src-var">$sSource </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a526"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&gt;= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a527"></a>            <span class="src-var">$sSource </span>= <span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'|^'</span>.<span class="src-id">str_repeat</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INDENT</span><span class="src-sym">, </span><span class="src-sym">(</span><span class="src-var">$iLevel </span>+ <span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">INDENT</span><span class="src-sym">)</span>.<span class="src-str">'|'</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sRealSource">sRealSource</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a528"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a> <span class="src-key">as </span><span class="src-var">$oChild</span><span class="src-sym">)</span></li>
<li><a name="a529"></a>            <span class="src-var">$sSource </span>.= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span>.<span class="src-var">$oChild</span><span class="src-sym">-&gt;</span><span class="src-id">getAsSource</span><span class="src-sym">(</span><span class="src-var">$iLevel</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a530"></a>        <span class="src-key">return </span><span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a531"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a532"></a>&nbsp;</li>
<li><a name="a533"></a><span class="src-str">    /**</span></li>
<li><a name="a534"></a><span class="src-str">     * Create and append line to parent</span></li>
<li><a name="a535"></a><span class="src-str">     *</span></li>
<li><a name="a536"></a><span class="src-str">     * @param string Line</span></li>
<li><a name="a537"></a><span class="src-str">     * @param object Parent parser</span></li>
<li><a name="a538"></a><span class="src-str">     * @param integer Line number</span></li>
<li><a name="a539"></a><span class="src-str">     * @return object</span></li>
<li><a name="a540"></a><span class="src-str">     */</span></li>
<li><a name="a541"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">createLine</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">,</span> <span class="src-var">$parent</span><span class="src-sym">,</span> <span class="src-var">$iLine</span> = <span class="src-id">null</span><span class="src-sym">)</span></span></li>
<li><a name="a542"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a543"></a><span class="src-str">        <span class="src-var">$oHaml</span> = <span class="src-key">new</span> <span class="src-id">HamlParser</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sPath">sPath</a><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bCompile">bCompile</a><span class="src-sym">, </span><span class="src-var">$parent</span><span class="src-sym">, </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'line'</span>=&gt;<span class="src-var">$iLine</span><span class="src-sym">, </span><span class="src-str">'file'</span>=&gt;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sFile">sFile</a><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a544"></a>        <span class="src-var">$oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">setSource</span><span class="src-sym">(</span><span class="src-id">rtrim</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">, </span><span class="src-str">&quot;\r&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a545"></a>        <span class="src-var">$oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">iIndent </span>= <span class="src-var">$parent</span><span class="src-sym">-&gt;</span><span class="src-id">iIndent </span>+ <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a546"></a>        <span class="src-var">$parent</span><span class="src-sym">-&gt;</span><span class="src-id">aChildren</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$oHaml</span><span class="src-sym">;</span></li>
<li><a name="a547"></a>        <span class="src-key">return </span><span class="src-var">$oHaml</span><span class="src-sym">;</span></li>
<li><a name="a548"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a549"></a>&nbsp;</li>
<li><a name="a550"></a><span class="src-str">    /**</span></li>
<li><a name="a551"></a><span class="src-str">     * Parse file</span></li>
<li><a name="a552"></a><span class="src-str">     *</span></li>
<li><a name="a553"></a><span class="src-str">     * @param array Array of source lines</span></li>
<li><a name="a554"></a><span class="src-str">     * @return string</span></li>
<li><a name="a555"></a><span class="src-str">     */</span></li>
<li><a name="a556"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">parseFile</span><span class="src-sym">(</span><span class="src-var">$aSource</span><span class="src-sym">)</span></span></li>
<li><a name="a557"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a558"></a><span class="src-str">        <span class="src-var">$aLevels</span> = <span class="src-key">array</span><span class="src-sym">(</span>-<span class="src-num">1</span> =&gt; <span class="src-var">$this</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a559"></a><span class="src-str">        <span class="src-var">$sCompiled</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a560"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aSource</span> <span class="src-key">as</span> <span class="src-var">$iKey</span> =&gt; <span class="src-var">$sSource</span><span class="src-sym">)</span></span></li>
<li><a name="a561"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a562"></a><span class="src-str">            <span class="src-var">$iLevel</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcountLevel">countLevel</a><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a563"></a>            <span class="src-var">$aLevels</span><span class="src-sym">[</span><span class="src-var">$iLevel</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcreateLine">createLine</a><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">, </span><span class="src-var">$aLevels</span><span class="src-sym">[</span><span class="src-var">$iLevel </span>- <span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$iKey </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a564"></a>        <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a565"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a> <span class="src-key">as </span><span class="src-var">$oChild</span><span class="src-sym">)</span></li>
<li><a name="a566"></a>            <span class="src-var">$sCompiled </span>.= <span class="src-var">$oChild</span><span class="src-sym">-&gt;</span><span class="src-id">render</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a567"></a>        <span class="src-var">$sCompiled </span>= <span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'|&lt;\?php \} \?&gt;\s*?&lt;\?php else \{ \?&gt;|ius'</span><span class="src-sym">, </span><span class="src-str">'&lt;?php } else { ?&gt;'</span><span class="src-sym">, </span><span class="src-var">$sCompiled</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a568"></a>        <span class="src-key">return </span><span class="src-var">$sCompiled</span><span class="src-sym">;</span></li>
<li><a name="a569"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a570"></a>&nbsp;</li>
<li><a name="a571"></a><span class="src-str">    /**</span></li>
<li><a name="a572"></a><span class="src-str">     * List of text processing blocks</span></li>
<li><a name="a573"></a><span class="src-str">     *</span></li>
<li><a name="a574"></a><span class="src-str">     * @var array</span></li>
<li><a name="a575"></a><span class="src-str">     */</span></li>
<li><a name="a576"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$aBlocks</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a577"></a>&nbsp;</li>
<li><a name="a578"></a><span class="src-str">    /**</span></li>
<li><a name="a579"></a><span class="src-str">     * Register block</span></li>
<li><a name="a580"></a><span class="src-str">     *</span></li>
<li><a name="a581"></a><span class="src-str">     * Text processing blocks are very usefull stuff ;)</span></li>
<li><a name="a582"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a583"></a><span class="src-str">     * // ...</span></li>
<li><a name="a584"></a><span class="src-str">     * %code.checksum</span></li>
<li><a name="a585"></a><span class="src-str">     * $tpl = &lt;&lt;&lt;__TPL__</span></li>
<li><a name="a586"></a><span class="src-str">     *   :md5</span></li>
<li><a name="a587"></a><span class="src-str">     *     Count MD5 checksum of me</span></li>
<li><a name="a588"></a><span class="src-str">     * __TPL__;</span></li>
<li><a name="a589"></a><span class="src-str">     * HamlParser::registerBlock('md5', 'md5');</span></li>
<li><a name="a590"></a><span class="src-str">     * $parser-&gt;display($tpl); // &lt;code class=&quot;checksum&quot;&gt;iejmgioemvijeejvijioj323&lt;/code&gt;</span></li>
<li><a name="a591"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a592"></a><span class="src-str">     *</span></li>
<li><a name="a593"></a><span class="src-str">     * @param mixed Callable</span></li>
<li><a name="a594"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a595"></a><span class="src-str">     */</span></li>
<li><a name="a596"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">static</span> <span class="src-key">function</span> <span class="src-id">registerBlock</span><span class="src-sym">(</span><span class="src-var">$mCallable</span><span class="src-sym">,</span> <span class="src-var">$sName</span> = <span class="src-id">false</span><span class="src-sym">)</span></span></li>
<li><a name="a597"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a598"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$sName</span><span class="src-sym">)</span></span></li>
<li><a name="a599"></a><span class="src-str">            <span class="src-var">$sName</span> = <span class="src-id">serialize</span><span class="src-sym">(</span><span class="src-var">$mCallable</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a600"></a><span class="src-str">        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aBlocks</span><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">]</span> = <span class="src-var">$mCallable</span><span class="src-sym">;</span></span></li>
<li><a name="a601"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a602"></a>&nbsp;</li>
<li><a name="a603"></a><span class="src-str">    /**</span></li>
<li><a name="a604"></a><span class="src-str">     * Unregister block</span></li>
<li><a name="a605"></a><span class="src-str">     *</span></li>
<li><a name="a606"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a607"></a><span class="src-str">     */</span></li>
<li><a name="a608"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">static</span> <span class="src-key">function</span> <span class="src-id">unregisterBlock</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">)</span></span></li>
<li><a name="a609"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a610"></a><span class="src-str">        unset<span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aBlocks</span><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a611"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a612"></a>&nbsp;</li>
<li><a name="a613"></a><span class="src-str">    /**</span></li>
<li><a name="a614"></a><span class="src-str">     * Parse text block</span></li>
<li><a name="a615"></a><span class="src-str">     *</span></li>
<li><a name="a616"></a><span class="src-str">     * @param string Block name</span></li>
<li><a name="a617"></a><span class="src-str">     * @param string Data</span></li>
<li><a name="a618"></a><span class="src-str">     * @return string</span></li>
<li><a name="a619"></a><span class="src-str">     */</span></li>
<li><a name="a620"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">parseTextBlock</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">,</span> <span class="src-var">$sText</span><span class="src-sym">)</span></span></li>
<li><a name="a621"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a622"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-id">call_user_func</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aBlocks</span><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">]</span><span class="src-sym">,</span> <span class="src-var">$sText</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a623"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a624"></a>&nbsp;</li>
<li><a name="a625"></a><span class="src-str">    /**</span></li>
<li><a name="a626"></a><span class="src-str">     * Eval embedded PHP code</span></li>
<li><a name="a627"></a><span class="src-str">     *</span></li>
<li><a name="a628"></a><span class="src-str">     * @see HamlParser::embedCode()</span></li>
<li><a name="a629"></a><span class="src-str">     * @var boolean</span></li>
<li><a name="a630"></a><span class="src-str">     */</span></li>
<li><a name="a631"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$bEmbed</span> = <span class="src-id">true</span><span class="src-sym">;</span></span></li>
<li><a name="a632"></a><span class="src-str">    </span></li>
<li><a name="a633"></a><span class="src-str">    /**</span></li>
<li><a name="a634"></a><span class="src-str">     * Eval embedded PHP code</span></li>
<li><a name="a635"></a><span class="src-str">     *</span></li>
<li><a name="a636"></a><span class="src-str">     * @param boolean</span></li>
<li><a name="a637"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a638"></a><span class="src-str">     */</span></li>
<li><a name="a639"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">embedCode</span><span class="src-sym">(</span><span class="src-var">$bEmbed</span> = <span class="src-id">null</span><span class="src-sym">)</span></span></li>
<li><a name="a640"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a641"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$bEmbed</span><span class="src-sym">))</span></span></li>
<li><a name="a642"></a><span class="src-str">            <span class="src-key">return</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$bEmbed</span><span class="src-sym">;</span></span></li>
<li><a name="a643"></a><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a644"></a><span class="src-str">            <span class="src-key">return</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$bEmbed</span> = <span class="src-var">$bEmbed</span><span class="src-sym">;</span></span></li>
<li><a name="a645"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a646"></a><span class="src-str">    </span></li>
<li><a name="a647"></a><span class="src-str">    /**</span></li>
<li><a name="a648"></a><span class="src-str">     * Instance for getInstance</span></li>
<li><a name="a649"></a><span class="src-str">     *</span></li>
<li><a name="a650"></a><span class="src-str">     * @see HamlParser::getInstance()</span></li>
<li><a name="a651"></a><span class="src-str">     * @var HamlParser</span></li>
<li><a name="a652"></a><span class="src-str">     */</span></li>
<li><a name="a653"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$oInstance</span> = <span class="src-id">null</span><span class="src-sym">;</span></span></li>
<li><a name="a654"></a>&nbsp;</li>
<li><a name="a655"></a><span class="src-str">    /**</span></li>
<li><a name="a656"></a><span class="src-str">     * Implements singleton pattern</span></li>
<li><a name="a657"></a><span class="src-str">     *</span></li>
<li><a name="a658"></a><span class="src-str">     * @see HamlParser::__construct()</span></li>
<li><a name="a659"></a><span class="src-str">     * @param string Path to files</span></li>
<li><a name="a660"></a><span class="src-str">     * @param boolean/string Compile templates (can be path)</span></li>
<li><a name="a661"></a><span class="src-str">     * @return HamlParser</span></li>
<li><a name="a662"></a><span class="src-str">     */</span></li>
<li><a name="a663"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-key">function</span> <span class="src-id">getInstance</span><span class="src-sym">(</span><span class="src-var">$sPath</span> = <span class="src-id">false</span><span class="src-sym">,</span> <span class="src-var">$bCompile</span> = <span class="src-id">true</span><span class="src-sym">)</span></span></li>
<li><a name="a664"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a665"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$oInstance</span><span class="src-sym">))</span></span></li>
<li><a name="a666"></a><span class="src-str">            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$oInstance</span> = <span class="src-key">new</span> <span class="src-id">self</span><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">,</span> <span class="src-var">$bCompile</span><span class="src-sym">,</span> <span class="src-id">null</span><span class="src-sym">,</span> <span class="src-id">null</span><span class="src-sym">,</span> <span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a667"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$oInstance</span><span class="src-sym">;</span></span></li>
<li><a name="a668"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a669"></a>&nbsp;</li>
<li><a name="a670"></a><span class="src-str">    /**</span></li>
<li><a name="a671"></a><span class="src-str">     * Remove white spaces??</span></li>
<li><a name="a672"></a><span class="src-str">     *</span></li>
<li><a name="a673"></a><span class="src-str">     * @var boolean</span></li>
<li><a name="a674"></a><span class="src-str">     * @access private</span></li>
<li><a name="a675"></a><span class="src-str">     */</span></li>
<li><a name="a676"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-var">$bRemoveBlank</span> = <span class="src-id">null</span><span class="src-sym">;</span></span></li>
<li><a name="a677"></a>&nbsp;</li>
<li><a name="a678"></a><span class="src-str">    /**</span></li>
<li><a name="a679"></a><span class="src-str">     * Remove white spaces</span></li>
<li><a name="a680"></a><span class="src-str">     *</span></li>
<li><a name="a681"></a><span class="src-str">     * @param boolean</span></li>
<li><a name="a682"></a><span class="src-str">     * @return HamlParser</span></li>
<li><a name="a683"></a><span class="src-str">     */</span></li>
<li><a name="a684"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">removeBlank</span><span class="src-sym">(</span><span class="src-var">$bRemoveBlank</span><span class="src-sym">)</span></span></li>
<li><a name="a685"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a686"></a><span class="src-str">        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a> = <span class="src-var">$bRemoveBlank</span><span class="src-sym">;</span></li>
<li><a name="a687"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a688"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a689"></a>&nbsp;</li>
<li><a name="a690"></a><span class="src-str">    /**</span></li>
<li><a name="a691"></a><span class="src-str">     * Parse line</span></li>
<li><a name="a692"></a><span class="src-str">     *</span></li>
<li><a name="a693"></a><span class="src-str">     * @param string Line</span></li>
<li><a name="a694"></a><span class="src-str">     * @return string</span></li>
<li><a name="a695"></a><span class="src-str">     */</span></li>
<li><a name="a696"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">parseLine</span><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">)</span></span></li>
<li><a name="a697"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a698"></a><span class="src-str">        <span class="src-var">$sParsed</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a699"></a><span class="src-str">        <span class="src-var">$sRealBegin</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a700"></a><span class="src-str">        <span class="src-var">$sRealEnd</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a701"></a><span class="src-str">        <span class="src-var">$sParsedBegin</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a702"></a><span class="src-str">        <span class="src-var">$sParsedEnd</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a703"></a><span class="src-str">        <span class="src-var">$bParse</span> = <span class="src-id">true</span><span class="src-sym">;</span></span></li>
<li><a name="a704"></a><span class="src-str">        <span class="src-comm">// Dynamic including</span></span></li>
<li><a name="a705"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INCLUDE</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_PARSE_PHP</span>.<span class="src-str">' (.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">)</span> &amp;&amp; <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodembedCode">embedCode</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a706"></a>        <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a707"></a><span class="src-str">            <span class="src-key">return</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">) </span>? <span class="src-str"><span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aDebug">aDebug</a><span class="src-sym">[</span><span class="src-str">'line'</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>:\t</span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span> == &lt;?<span class="src-id">php</span> <span class="src-id">var_export</span>(</span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>) ?&gt;\n\n<span class="src-str">"</span> : <span class="src-str">''</span><span class="src-sym">)</span> . <span class="src-str">"</span>&lt;?<span class="src-id">php</span> <span class="src-id">echo</span> \$<span class="src-id">this</span></span><span class="src-sym">-&gt;</span><span class="src-id">indent</span>(<span class="src-id">self</span>::<span class="src-id">getInstance</span>(\$<span class="src-id">this</span><span class="src-sym">-&gt;</span><span class="src-id">sPath</span>, \$<span class="src-id">this</span><span class="src-sym">-&gt;</span><span class="src-id">sTmp</span>)-&gt;<span class="src-id">fetch</span>(\$<span class="src-id">this</span><span class="src-sym">-&gt;</span><span class="src-id">getFilename</span>({<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>)), <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$iIndent">iIndent</a>, <span class="src-id">true</span>, <span class="src-id">false</span>); ?&gt;<span class="src-str"><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a708"></a><span class="src-str">        <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a709"></a><span class="src-str">        <span class="src-comm">// Doctype parsing</span></span></li>
<li><a name="a710"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_DOCTYPE</span>.<span class="src-str">'(.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a711"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a712"></a><span class="src-str">            <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a713"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> == <span class="src-str">''</span><span class="src-sym">)</span></span></li>
<li><a name="a714"></a><span class="src-str">              <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> = <span class="src-str">'1.1'</span><span class="src-sym">;</span></span></li>
<li><a name="a715"></a><span class="src-str">            <span class="src-var">$sParsed</span> = <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aDoctypes</span><span class="src-sym">[</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]]</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a716"></a><span class="src-str">        <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a717"></a><span class="src-str">        <span class="src-comm">// Internal comment</span></span></li>
<li><a name="a718"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_COMMENT</span>.<span class="src-str">'\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_COMMENT</span>.<span class="src-str">'/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">))</span></span></li>
<li><a name="a719"></a><span class="src-str">            <span class="src-key">return</span> <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a720"></a><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a721"></a><span class="src-str">        <span class="src-comm">// PHP instruction</span></span></li>
<li><a name="a722"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INSTRUCTION_PHP</span>.<span class="src-str">' (.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a723"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a724"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodembedCode">embedCode</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a725"></a>                <span class="src-key">return </span><span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a726"></a>            <span class="src-var">$bBlock </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a727"></a>            <span class="src-comm">// Check for block</span></li>
<li><a name="a728"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^('</span>.<span class="src-id">implode</span><span class="src-sym">(</span><span class="src-str">'|'</span><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aPhpBlocks</span><span class="src-sym">)</span>.<span class="src-str">')/'</span><span class="src-sym">, </span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a729"></a>              <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bBlock">bBlock</a> = <span class="src-var">$bBlock </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a730"></a>            <span class="src-var">$sParsedBegin </span>= <span class="src-str">'&lt;?php ' </span>. <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>. <span class="src-sym">(</span><span class="src-var">$bBlock </span>? <span class="src-str">' {' </span>: <span class="src-str">';'</span><span class="src-sym">)</span><span class="src-sym">, </span>-<span class="src-num">2</span><span class="src-sym">, </span><span class="src-id">false</span><span class="src-sym">)  </span>. <span class="src-str">'?&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a731"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$bBlock</span><span class="src-sym">)</span></li>
<li><a name="a732"></a>              <span class="src-var">$sParsedEnd </span>= <span class="src-str">'&lt;?php } ?&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a733"></a>        <span class="src-str"><span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a734"></a><span class="src-str">        <span class="src-comm">// Text block</span></span></li>
<li><a name="a735"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_TEXT_BLOCKS</span>.<span class="src-str">'(.+)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a736"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a737"></a><span class="src-str">            <span class="src-var">$sParsed</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodparseTextBlock">parseTextBlock</a><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodgetAsSource">getAsSource</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$iIndent">iIndent</a><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a738"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a739"></a>        <span class="src-str"><span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a740"></a><span class="src-str">        <span class="src-comm">// Check for PHP</span></span></li>
<li><a name="a741"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_PARSE_PHP</span>.<span class="src-str">' (.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a742"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodembedCode">embedCode</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a743"></a>                <span class="src-var">$sParsed </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;?<span class="src-id">php</span> <span class="src-id">echo</span> </span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>; ?&gt;<span class="src-str">"</span><span class="src-sym">)</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a744"></a><span class="src-str">            <span class="src-key">else</span></span></li>
<li><a name="a745"></a><span class="src-str">                <span class="src-var">$sParsed</span> = <span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a746"></a><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a747"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a748"></a><span class="src-str">            <span class="src-var">$aAttributes</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a749"></a><span class="src-str">            <span class="src-var">$sAttributes</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a750"></a><span class="src-str">            <span class="src-var">$sTag</span> = <span class="src-str">'div'</span><span class="src-sym">;</span></span></li>
<li><a name="a751"></a><span class="src-str">            <span class="src-var">$sToParse</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a752"></a><span class="src-str">            <span class="src-var">$sContent</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a753"></a><span class="src-str">            <span class="src-var">$sAutoVar</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a754"></a>&nbsp;</li>
<li><a name="a755"></a><span class="src-str">            <span class="src-comm">// Parse options</span></span></li>
<li><a name="a756"></a><span class="src-str">            <span class="src-key">while</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTIONS_LEFT</span>.<span class="src-str">'(.*?)\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTIONS_RIGHT</span>.<span class="src-str">'/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a757"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a758"></a><span class="src-str">                <span class="src-var">$sSource</span> = <span class="src-id">str_replace</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">,</span> <span class="src-str">''</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a759"></a><span class="src-str">                <span class="src-var">$aOptions</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTIONS_SEPARATOR</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a760"></a><span class="src-str">                <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aOptions</span> <span class="src-key">as</span> <span class="src-var">$sOption</span><span class="src-sym">)</span></span></li>
<li><a name="a761"></a><span class="src-str">                <span class="src-sym">{</span></span></li>
<li><a name="a762"></a><span class="src-str">                    <span class="src-var">$aOption</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTION_VALUE</span><span class="src-sym">,</span> <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$sOption</span><span class="src-sym">))</span><span class="src-sym">;</span></span></li>
<li><a name="a763"></a><span class="src-str">                    <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aOption</span> <span class="src-key">as</span> <span class="src-var">$k</span> =&gt; <span class="src-var">$o</span><span class="src-sym">)</span></span></li>
<li><a name="a764"></a><span class="src-str">                        <span class="src-var">$aOption</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$o</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a765"></a><span class="src-str">                    <span class="src-var">$sOptionName</span> = <span class="src-id">ltrim</span><span class="src-sym">(</span><span class="src-var">$aOption</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">,</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTION</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a766"></a><span class="src-str">                    <span class="src-var">$aAttributes</span><span class="src-sym">[</span><span class="src-var">$sOptionName</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$aOption</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">,</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_OPTION</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a767"></a><span class="src-str">                <span class="src-sym">}</span></span></li>
<li><a name="a768"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a769"></a>&nbsp;</li>
<li><a name="a770"></a><span class="src-str">            <span class="src-var">$sFirst</span> = <span class="src-str">'['</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_TAG</span>.<span class="src-str">'|'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_ID</span>.<span class="src-str">'|'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_CLASS</span>.<span class="src-str">'|'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_PARSE_PHP</span>.<span class="src-str">']'</span><span class="src-sym">;</span></span></li>
<li><a name="a771"></a>&nbsp;</li>
<li><a name="a772"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">"</span>/^(<span class="src-var">$sFirst</span>.*?) (.*)/<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a773"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a774"></a><span class="src-str">                <span class="src-var">$sToParse</span> = <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a775"></a><span class="src-str">                <span class="src-var">$sContent</span> = <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a776"></a><span class="src-str">            <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a777"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">"</span>/^(<span class="src-var">$sFirst</span>.*)/<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a778"></a><span class="src-str">                <span class="src-var">$sToParse</span> = <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a779"></a><span class="src-str">            <span class="src-key">else</span></span></li>
<li><a name="a780"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a781"></a><span class="src-str">                <span class="src-comm">// Check for comment</span></span></li>
<li><a name="a782"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_COMMENT</span>.<span class="src-str">'(.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a783"></a><span class="src-str">                <span class="src-sym">{</span></span></li>
<li><a name="a784"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcanIndent">canIndent</a><span class="src-sym">(</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a><span class="src-sym">)</span></li>
<li><a name="a785"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisFirst">isFirst</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a786"></a>                            <span class="src-var">$sParsed </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-id">false</span><span class="src-sym">) </span>. <span class="src-str">' '</span><span class="src-sym">; </span><span class="src-key">else</span></li>
<li><a name="a787"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisLast">isLast</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a788"></a>                            <span class="src-var">$sParsed </span>= <span class="src-str"><span class="src-str">"</span><span class="src-var">$sSource</span>\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a789"></a><span class="src-str">                        <span class="src-key">else</span></span></li>
<li><a name="a790"></a><span class="src-str">                            <span class="src-var">$sParsed</span> = <span class="src-str">"</span><span class="src-var">$sSource</span> <span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a791"></a><span class="src-str">                    <span class="src-key">else</span></span></li>
<li><a name="a792"></a><span class="src-str">                        <span class="src-var">$sParsed</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a793"></a>                    <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a> <span class="src-key">as </span><span class="src-var">$oChild</span><span class="src-sym">)</span></li>
<li><a name="a794"></a>                        <span class="src-var">$sParsed </span>.= <span class="src-var">$oChild</span><span class="src-sym">-&gt;</span><span class="src-id">render</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a795"></a>                <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a796"></a><span class="src-str">                <span class="src-key">else</span></span></li>
<li><a name="a797"></a><span class="src-str">                <span class="src-sym">{</span></span></li>
<li><a name="a798"></a><span class="src-str">                    <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a799"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> &amp;&amp; <span class="src-sym">!</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\[.*\]/'</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span></span></li>
<li><a name="a800"></a><span class="src-str">                        <span class="src-var">$sParsed</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-id">wordwrap</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-num">60</span><span class="src-sym">, </span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a801"></a>                <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a802"></a><span class="src-str">                <span class="src-var">$bParse</span> = <span class="src-id">false</span><span class="src-sym">;</span></span></li>
<li><a name="a803"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a804"></a>&nbsp;</li>
<li><a name="a805"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$bParse</span><span class="src-sym">)</span></span></li>
<li><a name="a806"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a807"></a><span class="src-str">                <span class="src-var">$bPhp</span> = <span class="src-id">false</span><span class="src-sym">;</span></span></li>
<li><a name="a808"></a><span class="src-str">                <span class="src-var">$bClosed</span> = <span class="src-id">false</span><span class="src-sym">;</span></span></li>
<li><a name="a809"></a><span class="src-str">                <span class="src-comm">// Match tag</span></span></li>
<li><a name="a810"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_TAG</span>.<span class="src-str">'([a-zA-Z0-9:\-_]*)/'</span><span class="src-sym">,</span> <span class="src-var">$sToParse</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a811"></a><span class="src-str">                    <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTag">sTag</a> = <span class="src-var">$sTag </span>= <span class="src-id">end</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// it's stack</span></li>
<li><a name="a812"></a>                <span class="src-comm">// Match ID</span></li>
<li><a name="a813"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_ID</span>.<span class="src-str">'([a-zA-Z0-9_]*)/'</span><span class="src-sym">, </span><span class="src-var">$sToParse</span><span class="src-sym">, </span><span class="src-var">$aMatches</span><span class="src-sym">))</span></li>
<li><a name="a814"></a>                    <span class="src-var">$aAttributes</span><span class="src-sym">[</span><span class="src-str">'id'</span><span class="src-sym">] </span>= <span class="src-str">'\''</span>.<span class="src-id">end</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span>.<span class="src-str">'\''</span><span class="src-sym">; </span><span class="src-comm">// it's stack</span></li>
<li><a name="a815"></a>                <span class="src-comm">// Match classes</span></li>
<li><a name="a816"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_CLASS</span>.<span class="src-str">'([a-zA-Z0-9\-_]*)/'</span><span class="src-sym">, </span><span class="src-var">$sToParse</span><span class="src-sym">, </span><span class="src-var">$aMatches</span><span class="src-sym">))</span></li>
<li><a name="a817"></a>                    <span class="src-var">$aAttributes</span><span class="src-sym">[</span><span class="src-str">'class'</span><span class="src-sym">] </span>= <span class="src-str">'\''</span>.<span class="src-id">implode</span><span class="src-sym">(</span><span class="src-str">' '</span><span class="src-sym">, </span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span>.<span class="src-str">'\''</span><span class="src-sym">;</span></li>
<li><a name="a818"></a>                <span class="src-comm">// Check for PHP</span></li>
<li><a name="a819"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_PARSE_PHP</span>.<span class="src-str">'/'</span><span class="src-sym">, </span><span class="src-var">$sToParse</span><span class="src-sym">))</span></li>
<li><a name="a820"></a>                <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a821"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodembedCode">embedCode</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a822"></a>                    <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a823"></a><span class="src-str">                        <span class="src-var">$sContentOld</span> = <span class="src-var">$sContent</span><span class="src-sym">;</span></span></li>
<li><a name="a824"></a><span class="src-str">                        <span class="src-var">$sContent</span> = <span class="src-str">"</span>&lt;?<span class="src-id">php</span> <span class="src-id">echo</span> <span class="src-var">$sContent</span>; ?&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a825"></a><span class="src-str">                        <span class="src-var">$bPhp</span> = <span class="src-id">true</span><span class="src-sym">;</span></span></li>
<li><a name="a826"></a><span class="src-str">                    <span class="src-sym">}</span></span></li>
<li><a name="a827"></a><span class="src-str">                    <span class="src-key">else</span></span></li>
<li><a name="a828"></a><span class="src-str">                        <span class="src-var">$sContent</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a829"></a><span class="src-str">                <span class="src-sym">}</span></span></li>
<li><a name="a830"></a><span class="src-str">                <span class="src-comm">// Match translating</span></span></li>
<li><a name="a831"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_TRANSLATE</span>.<span class="src-str">'$/'</span><span class="src-sym">,</span> <span class="src-var">$sToParse</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a832"></a><span class="src-str">                <span class="src-sym">{</span></span></li>
<li><a name="a833"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$bPhp</span><span class="src-sym">)</span></span></li>
<li><a name="a834"></a><span class="src-str">                        <span class="src-var">$sContent</span> = <span class="src-str">"</span>'<span class="src-var">$sContent</span>'<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a835"></a><span class="src-str">                    <span class="src-key">else</span></span></li>
<li><a name="a836"></a><span class="src-str">                        <span class="src-var">$sContent</span> = <span class="src-var">$sContentOld</span><span class="src-sym">;</span></span></li>
<li><a name="a837"></a><span class="src-str">                    <span class="src-var">$sContent</span> = <span class="src-str">"</span>&lt;?<span class="src-id">php</span> <span class="src-id">echo</span> </span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTranslate">sTranslate</a><span class="src-sym">}</span>(<span class="src-var">$sContent</span>); ?&gt;\n<span class="src-str"><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a838"></a><span class="src-str">                <span class="src-sym">}</span></span></li>
<li><a name="a839"></a><span class="src-str">                <span class="src-comm">// Match single tag</span></span></li>
<li><a name="a840"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_SINGLE</span>.<span class="src-str">'$/'</span><span class="src-sym">,</span> <span class="src-var">$sToParse</span><span class="src-sym">))</span></span></li>
<li><a name="a841"></a><span class="src-str">                    <span class="src-var">$bClosed</span> = <span class="src-id">true</span><span class="src-sym">;</span></span></li>
<li><a name="a842"></a><span class="src-str">                <span class="src-comm">// Match brackets</span></span></li>
<li><a name="a843"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_AUTO_LEFT</span>.<span class="src-str">'(.*?)\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_AUTO_RIGHT</span>.<span class="src-str">'/'</span><span class="src-sym">,</span> <span class="src-var">$sToParse</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">)</span> &amp;&amp; <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodembedCode">embedCode</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a844"></a>                    <span class="src-var">$sAutoVar </span>= <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a845"></a>&nbsp;</li>
<li><a name="a846"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$aAttributes</span><span class="src-sym">) </span>|| <span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sAutoVar</span><span class="src-sym">))</span></li>
<li><a name="a847"></a>                    <span class="src-var">$sAttributes </span>= <span class="src-str">'&lt;?php $this-&gt;writeAttributes('</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodarrayExport">arrayExport</a><span class="src-sym">(</span><span class="src-var">$aAttributes</span><span class="src-sym">)</span>.<span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sAutoVar</span><span class="src-sym">) </span>? <span class="src-str"><span class="src-str">"</span>, \$<span class="src-id">this</span></span><span class="src-sym">-&gt;</span><span class="src-id">parseSquareBrackets</span>(<span class="src-var">$sAutoVar</span>)<span class="src-str"><span class="src-str">"</span> : <span class="src-str">''</span> <span class="src-sym">)</span>.<span class="src-str">'); ?&gt;'</span><span class="src-sym">;</span></span></li>
<li><a name="a848"></a><span class="src-str">                <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bBlock">bBlock</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">bBlock</span><span class="src-sym">;</span></li>
<li><a name="a849"></a>                <span class="src-var">$iLevelM </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">bBlock </span>|| <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bBlock">bBlock</a> ? -<span class="src-num">1 </span>: <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a850"></a>                <span class="src-comm">// Check for closed tag</span></li>
<li><a name="a851"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisClosed">isClosed</a><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">) </span>|| <span class="src-var">$bClosed</span><span class="src-sym">)</span></li>
<li><a name="a852"></a>                    <span class="src-var">$sParsedBegin </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span> /&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-key">else</span></span></li>
<li><a name="a853"></a><span class="src-str">                <span class="src-comm">// Check for no indent tag</span></span></li>
<li><a name="a854"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">in_array</span><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">,</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aNoIndentTags</span><span class="src-sym">))</span></span></li>
<li><a name="a855"></a><span class="src-str">                <span class="src-sym">{</span></span></li>
<li><a name="a856"></a><span class="src-str">                    <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a857"></a>                    <span class="src-var">$sParsedBegin </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a858"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">))</span></span></li>
<li><a name="a859"></a><span class="src-str">                        <span class="src-var">$sParsed</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a860"></a>                    <span class="src-var">$sParsedEnd </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;/<span class="src-var">$sTag</span>&gt;\n<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a861"></a><span class="src-str">                <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a862"></a><span class="src-str">                <span class="src-comm">// Check for block tag</span></span></li>
<li><a name="a863"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisInline">isInline</a><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">))</span></li>
<li><a name="a864"></a>                <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a865"></a><span class="src-str">                    <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a866"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">))</span></span></li>
<li><a name="a867"></a><span class="src-str">                        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">)</span> > <span class="src-num">60</span><span class="src-sym">)</span></span></li>
<li><a name="a868"></a><span class="src-str">                            <span class="src-var">$sParsed</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-id">wordwrap</span><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">, </span><span class="src-num">60</span><span class="src-sym">, </span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span>+<span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a869"></a>                        <span class="src-key">else</span></li>
<li><a name="a870"></a>                            <span class="src-var">$sParsed </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-var">$sContent</span><span class="src-sym">, </span><span class="src-num">1</span>+<span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a871"></a>                    <span class="src-var">$sParsedEnd </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;/<span class="src-var">$sTag</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a872"></a><span class="src-str">                <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a873"></a><span class="src-str">                <span class="src-comm">// Check for inline tag</span></span></li>
<li><a name="a874"></a><span class="src-str">                <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisInline">isInline</a><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">))</span></li>
<li><a name="a875"></a>                <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a876"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcanIndent">canIndent</a><span class="src-sym">(</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a><span class="src-sym">)</span></li>
<li><a name="a877"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisFirst">isFirst</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a878"></a>                            <span class="src-var">$sParsedBegin </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">0</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-key">else</span></span></li>
<li><a name="a879"></a><span class="src-str">                        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisLast">isLast</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a880"></a>                            <span class="src-var">$sParsedBegin </span>= <span class="src-str"><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a881"></a><span class="src-str">                        <span class="src-key">else</span></span></li>
<li><a name="a882"></a><span class="src-str">                            <span class="src-var">$sParsedBegin</span> = <span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a883"></a><span class="src-str">                    <span class="src-key">else</span></span></li>
<li><a name="a884"></a><span class="src-str">                        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcanIndent">canIndent</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a885"></a>                            <span class="src-var">$sParsedBegin </span>= <span class="src-str">&quot;\n&quot; </span>. <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a886"></a><span class="src-str">                        <span class="src-key">else</span></span></li>
<li><a name="a887"></a><span class="src-str">                            <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;<span class="src-var">$sTag$sAttributes</span>&gt;<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-var">$iLevelM</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a888"></a><span class="src-str">                    <span class="src-var">$sParsed</span> = <span class="src-var">$sContent</span><span class="src-sym">;</span></span></li>
<li><a name="a889"></a><span class="src-str">                    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcanIndent">canIndent</a><span class="src-sym">(</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$bRemoveBlank">bRemoveBlank</a><span class="src-sym">)</span></li>
<li><a name="a890"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisLast">isLast</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a891"></a>                            <span class="src-var">$sParsedEnd </span>= <span class="src-str"><span class="src-str">"</span>&lt;/<span class="src-var">$sTag</span>&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a892"></a><span class="src-str">                        <span class="src-key">else</span></span></li>
<li><a name="a893"></a><span class="src-str">                            <span class="src-var">$sParsedEnd</span> = <span class="src-str">"</span>&lt;/<span class="src-var">$sTag</span>&gt; <span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a894"></a><span class="src-str">                    <span class="src-key">else</span></span></li>
<li><a name="a895"></a><span class="src-str">                        <span class="src-var">$sParsedEnd</span> = <span class="src-str">"</span>&lt;/<span class="src-var">$sTag</span>&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a896"></a><span class="src-str">                <span class="src-sym">}</span></span></li>
<li><a name="a897"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a898"></a><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a899"></a><span class="src-str">        <span class="src-comm">// Children appending</span></span></li>
<li><a name="a900"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a> <span class="src-key">as </span><span class="src-var">$oChild</span><span class="src-sym">)</span></li>
<li><a name="a901"></a>            <span class="src-var">$sParsed </span>.= <span class="src-var">$oChild</span><span class="src-sym">-&gt;</span><span class="src-id">fetch</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a902"></a>        <span class="src-comm">// Check for IE comment</span></li>
<li><a name="a903"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_COMMENT</span>.<span class="src-str">'\[(.*?)\](.*)/'</span><span class="src-sym">, </span><span class="src-var">$sSource</span><span class="src-sym">, </span><span class="src-var">$aMatches</span><span class="src-sym">))</span></li>
<li><a name="a904"></a>        <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a905"></a><span class="src-str">            <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a906"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">count</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a><span class="src-sym">) </span>== <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a907"></a>            <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a908"></a><span class="src-str">                <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;!--<span class="src-sym">[</span></span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span><span class="src-sym">]</span>&gt; <span class="src-var">$sParsedBegin</span><span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">0</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a909"></a><span class="src-str">                <span class="src-var">$sParsed</span> = <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a910"></a><span class="src-str">                <span class="src-var">$sParsedEnd</span> = <span class="src-str">"</span><span class="src-var">$sParsedEnd</span> &lt;!<span class="src-sym">[</span><span class="src-id">endif</span><span class="src-sym">]</span>--&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a911"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a912"></a><span class="src-str">            <span class="src-key">else</span></span></li>
<li><a name="a913"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a914"></a><span class="src-str">                <span class="src-var">$sParsed</span> = <span class="src-var">$sParsedBegin</span>.<span class="src-var">$sParsed</span>.<span class="src-var">$sParsedEnd</span><span class="src-sym">;</span></span></li>
<li><a name="a915"></a><span class="src-str">                <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;!--<span class="src-sym">[</span></span>{<span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span><span class="src-sym">]</span>&gt;<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a916"></a><span class="src-str">                <span class="src-var">$sParsedEnd</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-str">&quot;&lt;![endif]--&gt;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a917"></a>            <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a918"></a><span class="src-str">        <span class="src-sym">}</span> <span class="src-key">else</span></span></li>
<li><a name="a919"></a><span class="src-str">        <span class="src-comm">// Check for comment</span></span></li>
<li><a name="a920"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^\\'</span>.<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_COMMENT</span>.<span class="src-str">'(.*)/'</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$aMatches</span><span class="src-sym">))</span></span></li>
<li><a name="a921"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a922"></a><span class="src-str">            <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a923"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">count</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a><span class="src-sym">) </span>== <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a924"></a>            <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a925"></a><span class="src-str">                <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(<span class="src-str"></span><span class="src-str">"</span>&lt;!-- <span class="src-var">$sParsedBegin</span><span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">0</span><span class="src-sym">,</span> <span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a926"></a><span class="src-str">                <span class="src-var">$sParsed</span> = <span class="src-var">$aMatches</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a927"></a><span class="src-str">                <span class="src-var">$sParsedEnd</span> = <span class="src-str">"</span><span class="src-var">$sParsedEnd</span> --&gt;\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a928"></a><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a929"></a><span class="src-str">            <span class="src-key">else</span></span></li>
<li><a name="a930"></a><span class="src-str">            <span class="src-sym">{</span></span></li>
<li><a name="a931"></a><span class="src-str">                <span class="src-var">$sParsed</span> = <span class="src-var">$sParsedBegin</span>.<span class="src-var">$sParsed</span>.<span class="src-var">$sParsedEnd</span><span class="src-sym">;</span></span></li>
<li><a name="a932"></a><span class="src-str">                <span class="src-var">$sParsedBegin</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-str">&quot;&lt;!--&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a933"></a>                <span class="src-var">$sParsedEnd </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodindent">indent</a><span class="src-sym">(</span><span class="src-str">&quot;--&gt;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a934"></a>            <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a935"></a><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a936"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-id">count</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a937"></a>            <span class="src-var">$sParsedEnd </span>= <span class="src-str"><span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aDebug">aDebug</a><span class="src-sym">[</span><span class="src-str">'line'</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>:\t<span class="src-var">$sParsedEnd</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a938"></a><span class="src-str">        <span class="src-var">$sCompiled</span> = <span class="src-var">$sRealBegin</span>.<span class="src-var">$sParsedBegin</span>.<span class="src-var">$sParsed</span>.<span class="src-var">$sParsedEnd</span>.<span class="src-var">$sRealEnd</span><span class="src-sym">;</span></span></li>
<li><a name="a939"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodisDebug">isDebug</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a940"></a>            <span class="src-var">$sCompiled </span>= <span class="src-str"><span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aDebug">aDebug</a><span class="src-sym">[</span><span class="src-str">'line'</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span>:\t<span class="src-var">$sCompiled</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a941"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$sCompiled</span><span class="src-sym">;</span></span></li>
<li><a name="a942"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a943"></a>&nbsp;</li>
<li><a name="a944"></a><span class="src-str">    /**</span></li>
<li><a name="a945"></a><span class="src-str">     * Indent line</span></li>
<li><a name="a946"></a><span class="src-str">     *</span></li>
<li><a name="a947"></a><span class="src-str">     * @param string Line</span></li>
<li><a name="a948"></a><span class="src-str">     * @param integer Additional indention level</span></li>
<li><a name="a949"></a><span class="src-str">     * @param boolean Add new line</span></li>
<li><a name="a950"></a><span class="src-str">     * @param boolean Count level from parent</span></li>
<li><a name="a951"></a><span class="src-str">     * @return string</span></li>
<li><a name="a952"></a><span class="src-str">     */</span></li>
<li><a name="a953"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">indent</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">,</span> <span class="src-var">$iAdd</span> = <span class="src-num">0</span><span class="src-sym">,</span> <span class="src-var">$bNew</span> = <span class="src-id">true</span><span class="src-sym">,</span> <span class="src-var">$bCount</span> = <span class="src-id">true</span><span class="src-sym">)</span></span></li>
<li><a name="a954"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a955"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$bCount</span><span class="src-sym">)</span></li>
<li><a name="a956"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodcanIndent">canIndent</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a957"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sLine<span class="src-str"></span><span class="src-sym">{</span><span class="src-num">0</span><span class="src-sym">}</span> == <span class="src-str">'&lt;'</span><span class="src-sym">)</span></span></li>
<li><a name="a958"></a><span class="src-str">                    <span class="src-key">return</span> <span class="src-var">$sLine</span><span class="src-sym">;</span></span></li>
<li><a name="a959"></a><span class="src-str">                <span class="src-key">else</span></span></li>
<li><a name="a960"></a><span class="src-str">                    <span class="src-key">return</span> <span class="src-str">"</span><span class="src-var">$sLine</span>\n<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a961"></a><span class="src-str">        <span class="src-var">$aLine</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,</span> <span class="src-var">$sLine</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a962"></a><span class="src-str">        <span class="src-var">$sIndented</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a963"></a><span class="src-str">        <span class="src-var">$iLevel</span> = <span class="src-sym">(</span><span class="src-var">$bCount</span> ? <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$iIndent">iIndent</a> : <span class="src-num">0</span><span class="src-sym">) </span>+ <span class="src-var">$iAdd</span><span class="src-sym">;</span></li>
<li><a name="a964"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aLine </span><span class="src-key">as </span><span class="src-var">$sLine</span><span class="src-sym">)</span></li>
<li><a name="a965"></a>            <span class="src-var">$sIndented </span>.= <span class="src-id">str_repeat</span><span class="src-sym">(</span><span class="src-str">'  '</span><span class="src-sym">, </span><span class="src-var">$iLevel </span>&gt;= <span class="src-num">0 </span>? <span class="src-var">$iLevel </span>: <span class="src-num">0</span><span class="src-sym">)</span>.<span class="src-sym">(</span><span class="src-var">$bNew </span>? <span class="src-str"><span class="src-str">"</span><span class="src-var">$sLine</span>\n<span class="src-str">"</span> : <span class="src-var">$sLine</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a966"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$sIndented</span><span class="src-sym">;</span></span></li>
<li><a name="a967"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a968"></a>&nbsp;</li>
<li><a name="a969"></a><span class="src-str">    /**</span></li>
<li><a name="a970"></a><span class="src-str">     * Is first child of parent</span></li>
<li><a name="a971"></a><span class="src-str">     *</span></li>
<li><a name="a972"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a973"></a><span class="src-str">     */</span></li>
<li><a name="a974"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">isFirst</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a975"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a976"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a> instanceof <span class="src-id">HamlParser</span><span class="src-sym">)</span></li>
<li><a name="a977"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a978"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">aChildren </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">)</span></li>
<li><a name="a979"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>=== <span class="src-var">$this</span><span class="src-sym">)</span></li>
<li><a name="a980"></a>                <span class="src-key">return </span><span class="src-var">$key </span>== <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a981"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a982"></a>&nbsp;</li>
<li><a name="a983"></a><span class="src-str">    /**</span></li>
<li><a name="a984"></a><span class="src-str">     * Is last child of parent</span></li>
<li><a name="a985"></a><span class="src-str">     *</span></li>
<li><a name="a986"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a987"></a><span class="src-str">     */</span></li>
<li><a name="a988"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">isLast</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a989"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a990"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a> instanceof <span class="src-id">HamlParser</span><span class="src-sym">)</span></li>
<li><a name="a991"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a992"></a>        <span class="src-var">$count </span>= <span class="src-id">count</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">aChildren</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a993"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">aChildren </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">)</span></li>
<li><a name="a994"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>=== <span class="src-var">$this</span><span class="src-sym">)</span></li>
<li><a name="a995"></a>                <span class="src-key">return </span><span class="src-var">$key </span>== <span class="src-var">$count </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a996"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a997"></a>&nbsp;</li>
<li><a name="a998"></a><span class="src-str">    /**</span></li>
<li><a name="a999"></a><span class="src-str">     * Can indent (check for parent is NoIndentTag)</span></li>
<li><a name="a1000"></a><span class="src-str">     *</span></li>
<li><a name="a1001"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a1002"></a><span class="src-str">     */</span></li>
<li><a name="a1003"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">canIndent</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1004"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1005"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">in_array</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTag">sTag</a><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aNoIndentTags</span><span class="src-sym">))</span></li>
<li><a name="a1006"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1007"></a>        <span class="src-key">else</span></li>
<li><a name="a1008"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a> instanceof <span class="src-id">HamlParser</span><span class="src-sym">)</span></li>
<li><a name="a1009"></a>                <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$oParent">oParent</a><span class="src-sym">-&gt;</span><span class="src-id">canIndent</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1010"></a>            <span class="src-key">else</span></li>
<li><a name="a1011"></a>                <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1012"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1013"></a>&nbsp;</li>
<li><a name="a1014"></a><span class="src-str">    /**</span></li>
<li><a name="a1015"></a><span class="src-str">     * Indent Haml source</span></li>
<li><a name="a1016"></a><span class="src-str">     *</span></li>
<li><a name="a1017"></a><span class="src-str">     * @param string Source</span></li>
<li><a name="a1018"></a><span class="src-str">     * @param integer Level</span></li>
<li><a name="a1019"></a><span class="src-str">     * @return string</span></li>
<li><a name="a1020"></a><span class="src-str">     */</span></li>
<li><a name="a1021"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">sourceIndent</span><span class="src-sym">(</span><span class="src-var">$sSource</span><span class="src-sym">,</span> <span class="src-var">$iLevel</span><span class="src-sym">)</span></span></li>
<li><a name="a1022"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1023"></a><span class="src-str">        <span class="src-var">$aSource</span> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">,</span> <span class="src-var">$sSource</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1024"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aSource</span> <span class="src-key">as</span> <span class="src-var">$sKey</span> =&gt; <span class="src-var">$sValue</span><span class="src-sym">)</span></span></li>
<li><a name="a1025"></a><span class="src-str">            <span class="src-var">$aSource</span><span class="src-sym">[</span><span class="src-var">$sKey</span><span class="src-sym">]</span> = <span class="src-id">str_repeat</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INDENT</span><span class="src-sym">,</span> <span class="src-var">$iLevel</span> * <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">INDENT</span><span class="src-sym">)</span> . <span class="src-var">$sValue</span><span class="src-sym">;</span></span></li>
<li><a name="a1026"></a><span class="src-str">        <span class="src-var">$sSource</span> = <span class="src-id">implode</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_LINE</span><span class="src-sym">,</span> <span class="src-var">$aSource</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1027"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$sSource</span><span class="src-sym">;</span></span></li>
<li><a name="a1028"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1029"></a>&nbsp;</li>
<li><a name="a1030"></a><span class="src-str">    /**</span></li>
<li><a name="a1031"></a><span class="src-str">     * Count level of line</span></li>
<li><a name="a1032"></a><span class="src-str">     *</span></li>
<li><a name="a1033"></a><span class="src-str">     * @param string Line</span></li>
<li><a name="a1034"></a><span class="src-str">     * @return integer</span></li>
<li><a name="a1035"></a><span class="src-str">     */</span></li>
<li><a name="a1036"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">countLevel</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">)</span></span></li>
<li><a name="a1037"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1038"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">)</span> - <span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-id">trim</span><span class="src-sym">(</span><span class="src-var">$sLine</span><span class="src-sym">,</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TOKEN_INDENT</span><span class="src-sym">)))</span> / <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">INDENT</span><span class="src-sym">;</span></span></li>
<li><a name="a1039"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1040"></a>&nbsp;</li>
<li><a name="a1041"></a><span class="src-str">    /**</span></li>
<li><a name="a1042"></a><span class="src-str">     * Check for inline tag</span></li>
<li><a name="a1043"></a><span class="src-str">     *</span></li>
<li><a name="a1044"></a><span class="src-str">     * @param string Tag</span></li>
<li><a name="a1045"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a1046"></a><span class="src-str">     */</span></li>
<li><a name="a1047"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">isInline</span><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">)</span></span></li>
<li><a name="a1048"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1049"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a><span class="src-sym">) </span>&amp;&amp; <span class="src-id">in_array</span><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aInlineTags</span><span class="src-sym">)) </span>|| <span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aChildren">aChildren</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1050"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1051"></a>&nbsp;</li>
<li><a name="a1052"></a><span class="src-str">    /**</span></li>
<li><a name="a1053"></a><span class="src-str">     * Check for closed tag</span></li>
<li><a name="a1054"></a><span class="src-str">     *</span></li>
<li><a name="a1055"></a><span class="src-str">     * @param string Tag</span></li>
<li><a name="a1056"></a><span class="src-str">     * @return boolean</span></li>
<li><a name="a1057"></a><span class="src-str">     */</span></li>
<li><a name="a1058"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">isClosed</span><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">)</span></span></li>
<li><a name="a1059"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1060"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-id">in_array</span><span class="src-sym">(</span><span class="src-var">$sTag</span><span class="src-sym">,</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aClosedTags</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1061"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1062"></a>&nbsp;</li>
<li><a name="a1063"></a><span class="src-str">    /**</span></li>
<li><a name="a1064"></a><span class="src-str">     * End of line character</span></li>
<li><a name="a1065"></a><span class="src-str">     */</span></li>
<li><a name="a1066"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_LINE</span> = <span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a1067"></a>&nbsp;</li>
<li><a name="a1068"></a><span class="src-str">    /**</span></li>
<li><a name="a1069"></a><span class="src-str">     * Indention token</span></li>
<li><a name="a1070"></a><span class="src-str">     */</span></li>
<li><a name="a1071"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_INDENT</span> = <span class="src-str">' '</span><span class="src-sym">;</span></span></li>
<li><a name="a1072"></a>&nbsp;</li>
<li><a name="a1073"></a><span class="src-str">    /**</span></li>
<li><a name="a1074"></a><span class="src-str">     * Create tag (%strong, %div)</span></li>
<li><a name="a1075"></a><span class="src-str">     */</span></li>
<li><a name="a1076"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_TAG</span> = <span class="src-str">'%'</span><span class="src-sym">;</span></span></li>
<li><a name="a1077"></a>&nbsp;</li>
<li><a name="a1078"></a><span class="src-str">    /**</span></li>
<li><a name="a1079"></a><span class="src-str">     * Set element ID (#foo, %strong#bar)</span></li>
<li><a name="a1080"></a><span class="src-str">     */</span></li>
<li><a name="a1081"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_ID</span> = <span class="src-str">'#'</span><span class="src-sym">;</span></span></li>
<li><a name="a1082"></a>&nbsp;</li>
<li><a name="a1083"></a><span class="src-str">    /**</span></li>
<li><a name="a1084"></a><span class="src-str">     * Set element class (.foo, %strong.lorem.ipsum)</span></li>
<li><a name="a1085"></a><span class="src-str">     */</span></li>
<li><a name="a1086"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_CLASS</span> = <span class="src-str">'.'</span><span class="src-sym">;</span></span></li>
<li><a name="a1087"></a>&nbsp;</li>
<li><a name="a1088"></a><span class="src-str">    /**</span></li>
<li><a name="a1089"></a><span class="src-str">     * Start the options (attributes) list</span></li>
<li><a name="a1090"></a><span class="src-str">     */</span></li>
<li><a name="a1091"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_OPTIONS_LEFT</span> = <span class="src-str">'{'</span><span class="src-sym">;</span></span></li>
<li><a name="a1092"></a>&nbsp;</li>
<li><a name="a1093"></a><span class="src-str">    /**</span></li>
<li><a name="a1094"></a><span class="src-str">     * End the options list</span></li>
<li><a name="a1095"></a><span class="src-str">     */</span></li>
<li><a name="a1096"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_OPTIONS_RIGHT</span> = <span class="src-str">'}'</span><span class="src-sym">;</span></span></li>
<li><a name="a1097"></a>&nbsp;</li>
<li><a name="a1098"></a><span class="src-str">    /**</span></li>
<li><a name="a1099"></a><span class="src-str">     * Options separator</span></li>
<li><a name="a1100"></a><span class="src-str">     */</span></li>
<li><a name="a1101"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_OPTIONS_SEPARATOR</span> = <span class="src-str">','</span><span class="src-sym">;</span></span></li>
<li><a name="a1102"></a>&nbsp;</li>
<li><a name="a1103"></a><span class="src-str">    /**</span></li>
<li><a name="a1104"></a><span class="src-str">     * Start option name</span></li>
<li><a name="a1105"></a><span class="src-str">     */</span></li>
<li><a name="a1106"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_OPTION</span> = <span class="src-str">':'</span><span class="src-sym">;</span></span></li>
<li><a name="a1107"></a>&nbsp;</li>
<li><a name="a1108"></a><span class="src-str">    /**</span></li>
<li><a name="a1109"></a><span class="src-str">     * Start option value</span></li>
<li><a name="a1110"></a><span class="src-str">     */</span></li>
<li><a name="a1111"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_OPTION_VALUE</span> = <span class="src-str">'=&gt;'</span><span class="src-sym">;</span></span></li>
<li><a name="a1112"></a>&nbsp;</li>
<li><a name="a1113"></a><span class="src-str">    /**</span></li>
<li><a name="a1114"></a><span class="src-str">     * Begin PHP instruction (without displaying)</span></li>
<li><a name="a1115"></a><span class="src-str">     */</span></li>
<li><a name="a1116"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_INSTRUCTION_PHP</span> = <span class="src-str">'-'</span><span class="src-sym">;</span></span></li>
<li><a name="a1117"></a>&nbsp;</li>
<li><a name="a1118"></a><span class="src-str">    /**</span></li>
<li><a name="a1119"></a><span class="src-str">     * Parse PHP (and display)</span></li>
<li><a name="a1120"></a><span class="src-str">     */</span></li>
<li><a name="a1121"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_PARSE_PHP</span> = <span class="src-str">'='</span><span class="src-sym">;</span></span></li>
<li><a name="a1122"></a>&nbsp;</li>
<li><a name="a1123"></a><span class="src-str">    /**</span></li>
<li><a name="a1124"></a><span class="src-str">     * Set DOCTYPE or XML header (!!! 1.1, !!!, !!! XML)</span></li>
<li><a name="a1125"></a><span class="src-str">     */</span></li>
<li><a name="a1126"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_DOCTYPE</span> = <span class="src-str">'!!!'</span><span class="src-sym">;</span></span></li>
<li><a name="a1127"></a>&nbsp;</li>
<li><a name="a1128"></a><span class="src-str">    /**</span></li>
<li><a name="a1129"></a><span class="src-str">     * Include file (!! tpl2)</span></li>
<li><a name="a1130"></a><span class="src-str">     */</span></li>
<li><a name="a1131"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_INCLUDE</span> = <span class="src-str">'!!'</span><span class="src-sym">;</span></span></li>
<li><a name="a1132"></a>&nbsp;</li>
<li><a name="a1133"></a><span class="src-str">    /**</span></li>
<li><a name="a1134"></a><span class="src-str">     * Comment code (block and inline)</span></li>
<li><a name="a1135"></a><span class="src-str">     */</span></li>
<li><a name="a1136"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_COMMENT</span> = <span class="src-str">'/'</span><span class="src-sym">;</span></span></li>
<li><a name="a1137"></a>&nbsp;</li>
<li><a name="a1138"></a><span class="src-str">    /**</span></li>
<li><a name="a1139"></a><span class="src-str">     * Translate content (%strong$ Translate)</span></li>
<li><a name="a1140"></a><span class="src-str">     */</span></li>
<li><a name="a1141"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_TRANSLATE</span> = <span class="src-str">'$'</span><span class="src-sym">;</span></span></li>
<li><a name="a1142"></a>&nbsp;</li>
<li><a name="a1143"></a><span class="src-str">    /**</span></li>
<li><a name="a1144"></a><span class="src-str">     * Mark level (%strong?3, !! foo?3)</span></li>
<li><a name="a1145"></a><span class="src-str">     */</span></li>
<li><a name="a1146"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_LEVEL</span> = <span class="src-str">'?'</span><span class="src-sym">;</span></span></li>
<li><a name="a1147"></a>&nbsp;</li>
<li><a name="a1148"></a><span class="src-str">    /**</span></li>
<li><a name="a1149"></a><span class="src-str">     * Create single, closed tag (%meta{ :foo =&gt; 'bar'}/)</span></li>
<li><a name="a1150"></a><span class="src-str">     */</span></li>
<li><a name="a1151"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_SINGLE</span> = <span class="src-str">'/'</span><span class="src-sym">;</span></span></li>
<li><a name="a1152"></a>&nbsp;</li>
<li><a name="a1153"></a><span class="src-str">    /**</span></li>
<li><a name="a1154"></a><span class="src-str">     * Break line</span></li>
<li><a name="a1155"></a><span class="src-str">     */</span></li>
<li><a name="a1156"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_BREAK</span> = <span class="src-str">'|'</span><span class="src-sym">;</span></span></li>
<li><a name="a1157"></a>&nbsp;</li>
<li><a name="a1158"></a><span class="src-str">    /**</span></li>
<li><a name="a1159"></a><span class="src-str">     * Begin automatic id and classes naming (%tr[$model])</span></li>
<li><a name="a1160"></a><span class="src-str">     */</span></li>
<li><a name="a1161"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_AUTO_LEFT</span> = <span class="src-str">'['</span><span class="src-sym">;</span></span></li>
<li><a name="a1162"></a>&nbsp;</li>
<li><a name="a1163"></a><span class="src-str">    /**</span></li>
<li><a name="a1164"></a><span class="src-str">     * End automatic id and classes naming</span></li>
<li><a name="a1165"></a><span class="src-str">     */</span></li>
<li><a name="a1166"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_AUTO_RIGHT</span> = <span class="src-str">']'</span><span class="src-sym">;</span></span></li>
<li><a name="a1167"></a>&nbsp;</li>
<li><a name="a1168"></a><span class="src-str">    /**</span></li>
<li><a name="a1169"></a><span class="src-str">     * Insert text block (:textile)</span></li>
<li><a name="a1170"></a><span class="src-str">     */</span></li>
<li><a name="a1171"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">TOKEN_TEXT_BLOCKS</span> = <span class="src-str">':'</span><span class="src-sym">;</span></span></li>
<li><a name="a1172"></a>&nbsp;</li>
<li><a name="a1173"></a><span class="src-str">    /**</span></li>
<li><a name="a1174"></a><span class="src-str">     * Number of TOKEN_INDENT to indent</span></li>
<li><a name="a1175"></a><span class="src-str">     */</span></li>
<li><a name="a1176"></a><span class="src-str">    <span class="src-key">const</span> <span class="src-id">INDENT</span> = <span class="src-num">2</span><span class="src-sym">;</span></span></li>
<li><a name="a1177"></a>&nbsp;</li>
<li><a name="a1178"></a><span class="src-str">    /**</span></li>
<li><a name="a1179"></a><span class="src-str">     * Doctype definitions</span></li>
<li><a name="a1180"></a><span class="src-str">     *</span></li>
<li><a name="a1181"></a><span class="src-str">     * @var string</span></li>
<li><a name="a1182"></a><span class="src-str">     */</span></li>
<li><a name="a1183"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$aDoctypes</span> = <span class="src-key">array</span></span></li>
<li><a name="a1184"></a><span class="src-str">    <span class="src-sym">(</span></span></li>
<li><a name="a1185"></a><span class="src-str">        <span class="src-str">'1.1'</span> =&gt; <span class="src-str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;&gt;'</span><span class="src-sym">,</span></span></li>
<li><a name="a1186"></a><span class="src-str">        <span class="src-str">'Strict'</span> =&gt; <span class="src-str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;'</span><span class="src-sym">,</span></span></li>
<li><a name="a1187"></a><span class="src-str">        <span class="src-str">'Transitional'</span> =&gt; <span class="src-str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;'</span><span class="src-sym">,</span></span></li>
<li><a name="a1188"></a><span class="src-str">        <span class="src-str">'Frameset'</span> =&gt; <span class="src-str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;&gt;'</span><span class="src-sym">,</span></span></li>
<li><a name="a1189"></a><span class="src-str">        <span class="src-str">'XML'</span> =&gt; <span class="src-str">&quot;&lt;?php echo '&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;'; ?&gt;\n&quot;</span></span></li>
<li><a name="a1190"></a><span class="src-str">    <span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1191"></a>&nbsp;</li>
<li><a name="a1192"></a><span class="src-str">    /**</span></li>
<li><a name="a1193"></a><span class="src-str">     * List of inline tags</span></li>
<li><a name="a1194"></a><span class="src-str">     *</span></li>
<li><a name="a1195"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1196"></a><span class="src-str">     */</span></li>
<li><a name="a1197"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">static</span> <span class="src-var">$aInlineTags</span> = <span class="src-key">array</span></span></li>
<li><a name="a1198"></a><span class="src-str">    <span class="src-sym">(</span></span></li>
<li><a name="a1199"></a><span class="src-str">        <span class="src-str">'a'</span><span class="src-sym">,</span> <span class="src-str">'strong'</span><span class="src-sym">,</span> <span class="src-str">'b'</span><span class="src-sym">,</span> <span class="src-str">'em'</span><span class="src-sym">,</span> <span class="src-str">'i'</span><span class="src-sym">,</span> <span class="src-str">'h1'</span><span class="src-sym">,</span> <span class="src-str">'h2'</span><span class="src-sym">,</span> <span class="src-str">'h3'</span><span class="src-sym">,</span> <span class="src-str">'h4'</span><span class="src-sym">,</span></span></li>
<li><a name="a1200"></a><span class="src-str">        <span class="src-str">'h5'</span><span class="src-sym">,</span> <span class="src-str">'h6'</span><span class="src-sym">,</span> <span class="src-str">'span'</span><span class="src-sym">,</span> <span class="src-str">'title'</span><span class="src-sym">,</span> <span class="src-str">'li'</span><span class="src-sym">,</span> <span class="src-str">'dt'</span><span class="src-sym">,</span> <span class="src-str">'dd'</span><span class="src-sym">,</span> <span class="src-str">'code'</span><span class="src-sym">,</span></span></li>
<li><a name="a1201"></a><span class="src-str">        <span class="src-str">'cite'</span><span class="src-sym">,</span> <span class="src-str">'td'</span><span class="src-sym">,</span> <span class="src-str">'th'</span><span class="src-sym">,</span> <span class="src-str">'abbr'</span><span class="src-sym">,</span> <span class="src-str">'acronym'</span><span class="src-sym">,</span> <span class="src-str">'legend'</span><span class="src-sym">,</span> <span class="src-str">'label'</span></span></li>
<li><a name="a1202"></a><span class="src-str">    <span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1203"></a>&nbsp;</li>
<li><a name="a1204"></a><span class="src-str">    /**</span></li>
<li><a name="a1205"></a><span class="src-str">     * List of closed tags (like br, link...)</span></li>
<li><a name="a1206"></a><span class="src-str">     *</span></li>
<li><a name="a1207"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1208"></a><span class="src-str">     */</span></li>
<li><a name="a1209"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">static</span> <span class="src-var">$aClosedTags</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'br'</span><span class="src-sym">,</span> <span class="src-str">'hr'</span><span class="src-sym">,</span> <span class="src-str">'link'</span><span class="src-sym">,</span> <span class="src-str">'meta'</span><span class="src-sym">,</span> <span class="src-str">'img'</span><span class="src-sym">,</span> <span class="src-str">'input'</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1210"></a>&nbsp;</li>
<li><a name="a1211"></a><span class="src-str">    /**</span></li>
<li><a name="a1212"></a><span class="src-str">     * List of tags which can't be indented</span></li>
<li><a name="a1213"></a><span class="src-str">     *</span></li>
<li><a name="a1214"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1215"></a><span class="src-str">     */</span></li>
<li><a name="a1216"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">static</span> <span class="src-var">$aNoIndentTags</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'pre'</span><span class="src-sym">,</span> <span class="src-str">'textarea'</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1217"></a>&nbsp;</li>
<li><a name="a1218"></a><span class="src-str">    /**</span></li>
<li><a name="a1219"></a><span class="src-str">     * List of PHP blocks</span></li>
<li><a name="a1220"></a><span class="src-str">     *</span></li>
<li><a name="a1221"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1222"></a><span class="src-str">     *</span></li>
<li><a name="a1223"></a><span class="src-str">     */</span></li>
<li><a name="a1224"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$aPhpBlocks</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'if'</span><span class="src-sym">,</span> <span class="src-str">'else'</span><span class="src-sym">,</span> <span class="src-str">'elseif'</span><span class="src-sym">,</span> <span class="src-str">'while'</span><span class="src-sym">,</span> <span class="src-str">'switch'</span><span class="src-sym">,</span> <span class="src-str">'for'</span><span class="src-sym">,</span> <span class="src-str">'do'</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1225"></a>&nbsp;</li>
<li><a name="a1226"></a><span class="src-str">    <span class="src-comm">// Template engine</span></span></li>
<li><a name="a1227"></a>&nbsp;</li>
<li><a name="a1228"></a><span class="src-str">    /**</span></li>
<li><a name="a1229"></a><span class="src-str">     * Template variables</span></li>
<li><a name="a1230"></a><span class="src-str">     *</span></li>
<li><a name="a1231"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1232"></a><span class="src-str">     */</span></li>
<li><a name="a1233"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">static</span> <span class="src-var">$aVariables</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1234"></a>&nbsp;</li>
<li><a name="a1235"></a><span class="src-str">    /**</span></li>
<li><a name="a1236"></a><span class="src-str">     * Assign variable</span></li>
<li><a name="a1237"></a><span class="src-str">     *</span></li>
<li><a name="a1238"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a1239"></a><span class="src-str">     * // ...</span></li>
<li><a name="a1240"></a><span class="src-str">     * $parser-&gt;assign('foo', 'bar');</span></li>
<li><a name="a1241"></a><span class="src-str">     * $lorem = 'ipsum';</span></li>
<li><a name="a1242"></a><span class="src-str">     * $parser-&gt;assign('example', $lorem);</span></li>
<li><a name="a1243"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a1244"></a><span class="src-str">     *</span></li>
<li><a name="a1245"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a1246"></a><span class="src-str">     * @param mixed Value</span></li>
<li><a name="a1247"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1248"></a><span class="src-str">     */</span></li>
<li><a name="a1249"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">assign</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">,</span> <span class="src-var">$sValue</span><span class="src-sym">)</span></span></li>
<li><a name="a1250"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1251"></a><span class="src-str">        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">]</span> = <span class="src-var">$sValue</span><span class="src-sym">;</span></span></li>
<li><a name="a1252"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$this</span><span class="src-sym">;</span></span></li>
<li><a name="a1253"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1254"></a>&nbsp;</li>
<li><a name="a1255"></a><span class="src-str">    /**</span></li>
<li><a name="a1256"></a><span class="src-str">     * Assign associative array of variables</span></li>
<li><a name="a1257"></a><span class="src-str">     *</span></li>
<li><a name="a1258"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a1259"></a><span class="src-str">     * // ...</span></li>
<li><a name="a1260"></a><span class="src-str">     * $parser-&gt;append(array('foo' =&gt; 'bar', 'lorem' =&gt; 'ipsum');</span></li>
<li><a name="a1261"></a><span class="src-str">     * $data = array</span></li>
<li><a name="a1262"></a><span class="src-str">     * (</span></li>
<li><a name="a1263"></a><span class="src-str">     *   'x' =&gt; 10,</span></li>
<li><a name="a1264"></a><span class="src-str">     *   'y' =&gt; 5</span></li>
<li><a name="a1265"></a><span class="src-str">     * );</span></li>
<li><a name="a1266"></a><span class="src-str">     * $parser-&gt;append($data);</span></li>
<li><a name="a1267"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a1268"></a><span class="src-str">     *</span></li>
<li><a name="a1269"></a><span class="src-str">     * @param array Data</span></li>
<li><a name="a1270"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1271"></a><span class="src-str">     */</span></li>
<li><a name="a1272"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$aData</span><span class="src-sym">)</span></span></li>
<li><a name="a1273"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1274"></a><span class="src-str">        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span> = <span class="src-id">array_merge</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span><span class="src-sym">,</span> <span class="src-var">$aData</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1275"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$this</span><span class="src-sym">;</span></span></li>
<li><a name="a1276"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1277"></a>&nbsp;</li>
<li><a name="a1278"></a><span class="src-str">    /**</span></li>
<li><a name="a1279"></a><span class="src-str">     * Removes variables</span></li>
<li><a name="a1280"></a><span class="src-str">     *</span></li>
<li><a name="a1281"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1282"></a><span class="src-str">     */</span></li>
<li><a name="a1283"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">clearVariables</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1284"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1285"></a><span class="src-str">        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1286"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$this</span><span class="src-sym">;</span></span></li>
<li><a name="a1287"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1288"></a>&nbsp;</li>
<li><a name="a1289"></a><span class="src-str">    /**</span></li>
<li><a name="a1290"></a><span class="src-str">     * Remove all compiled templates (*.hphp files)</span></li>
<li><a name="a1291"></a><span class="src-str">     *</span></li>
<li><a name="a1292"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1293"></a><span class="src-str">     */</span></li>
<li><a name="a1294"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">clearCompiled</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1295"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1296"></a><span class="src-str">        <span class="src-var">$oDirs</span> = <span class="src-key">new</span> <span class="src-id">DirectoryIterator</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$sTmp">sTmp</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1297"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$oDirs </span><span class="src-key">as </span><span class="src-var">$oDir</span><span class="src-sym">)</span></li>
<li><a name="a1298"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$oDir</span><span class="src-sym">-&gt;</span><span class="src-id">isDot</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1299"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/\.hphp/'</span><span class="src-sym">, </span><span class="src-var">$oDir</span><span class="src-sym">-&gt;</span><span class="src-id">getPathname</span><span class="src-sym">(</span><span class="src-sym">)))</span></li>
<li><a name="a1300"></a>                <span class="src-id">unlink</span><span class="src-sym">(</span><span class="src-var">$oDir</span><span class="src-sym">-&gt;</span><span class="src-id">getPathname</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1301"></a>                <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a1302"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1303"></a>&nbsp;</li>
<li><a name="a1304"></a><span class="src-str">    /**</span></li>
<li><a name="a1305"></a><span class="src-str">     * Return compiled template</span></li>
<li><a name="a1306"></a><span class="src-str">     *</span></li>
<li><a name="a1307"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a1308"></a><span class="src-str">     * // ...</span></li>
<li><a name="a1309"></a><span class="src-str">     * echo $parser-&gt;setSource('%strong Foo')-&gt;fetch(); // &lt;strong&gt;Foo&lt;/strong&gt;</span></li>
<li><a name="a1310"></a><span class="src-str">     * $parser-&gt;setSource('%strong Bar')-&gt;display(); // &lt;strong&gt;Bar&lt;/strong&gt;</span></li>
<li><a name="a1311"></a><span class="src-str">     * echo $parser-&gt;setSource('%em Linux'); // &lt;strong&gt;Linux&lt;/strong&gt;</span></li>
<li><a name="a1312"></a><span class="src-str">     *</span></li>
<li><a name="a1313"></a><span class="src-str">     * echo $parser-&gt;fetch('bar.haml'); // Compile and display bar.haml</span></li>
<li><a name="a1314"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a1315"></a><span class="src-str">     *</span></li>
<li><a name="a1316"></a><span class="src-str">     * @param string Filename</span></li>
<li><a name="a1317"></a><span class="src-str">     * @return string</span></li>
<li><a name="a1318"></a><span class="src-str">     */</span></li>
<li><a name="a1319"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">fetch</span><span class="src-sym">(</span><span class="src-var">$sFilename</span> = <span class="src-id">false</span><span class="src-sym">)</span></span></li>
<li><a name="a1320"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1321"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">)</span></span></li>
<li><a name="a1322"></a><span class="src-str">            <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodsetFile">setFile</a><span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1323"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodrender">render</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1324"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1325"></a>&nbsp;</li>
<li><a name="a1326"></a><span class="src-str">    /**</span></li>
<li><a name="a1327"></a><span class="src-str">     * Display template</span></li>
<li><a name="a1328"></a><span class="src-str">     *</span></li>
<li><a name="a1329"></a><span class="src-str">     * @see HamlParser::fetch()</span></li>
<li><a name="a1330"></a><span class="src-str">     * @param string Filename</span></li>
<li><a name="a1331"></a><span class="src-str">     */</span></li>
<li><a name="a1332"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">display</span><span class="src-sym">(</span><span class="src-var">$sFilename</span> = <span class="src-id">false</span><span class="src-sym">)</span></span></li>
<li><a name="a1333"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1334"></a><span class="src-str">        echo <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#methodfetch">fetch</a><span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1335"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1336"></a>&nbsp;</li>
<li><a name="a1337"></a><span class="src-str">    /**</span></li>
<li><a name="a1338"></a><span class="src-str">     * List of registered filters</span></li>
<li><a name="a1339"></a><span class="src-str">     *</span></li>
<li><a name="a1340"></a><span class="src-str">     * @var array</span></li>
<li><a name="a1341"></a><span class="src-str">     */</span></li>
<li><a name="a1342"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-var">$aFilters</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1343"></a>&nbsp;</li>
<li><a name="a1344"></a><span class="src-str">    /**</span></li>
<li><a name="a1345"></a><span class="src-str">     * Register output filter.</span></li>
<li><a name="a1346"></a><span class="src-str">     *</span></li>
<li><a name="a1347"></a><span class="src-str">     * Filters are next usefull stuff. For example if</span></li>
<li><a name="a1348"></a><span class="src-str">     * you want remove &lt;em&gt;all&lt;/em&gt; whitespaces (blah) use this</span></li>
<li><a name="a1349"></a><span class="src-str">     * &lt;code&gt;</span></li>
<li><a name="a1350"></a><span class="src-str">     * // ...</span></li>
<li><a name="a1351"></a><span class="src-str">     * function fcw($data)</span></li>
<li><a name="a1352"></a><span class="src-str">     * {</span></li>
<li><a name="a1353"></a><span class="src-str">     *   return preg_replace('|\s*|', '', $data);</span></li>
<li><a name="a1354"></a><span class="src-str">     * }</span></li>
<li><a name="a1355"></a><span class="src-str">     * $parser-&gt;registerFilter('fcw');</span></li>
<li><a name="a1356"></a><span class="src-str">     * echo $parser-&gt;fetch('foo.haml');</span></li>
<li><a name="a1357"></a><span class="src-str">     * &lt;/code&gt;</span></li>
<li><a name="a1358"></a><span class="src-str">     *</span></li>
<li><a name="a1359"></a><span class="src-str">     * @param callable Filter</span></li>
<li><a name="a1360"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a1361"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1362"></a><span class="src-str">     */</span></li>
<li><a name="a1363"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">registerFilter</span><span class="src-sym">(</span><span class="src-var">$mCallable</span><span class="src-sym">,</span> <span class="src-var">$sName</span> = <span class="src-id">false</span><span class="src-sym">)</span></span></li>
<li><a name="a1364"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1365"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$sName</span><span class="src-sym">)</span></span></li>
<li><a name="a1366"></a><span class="src-str">            <span class="src-var">$sName</span> = <span class="src-id">serialize</span><span class="src-sym">(</span><span class="src-var">$mCallable</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1367"></a><span class="src-str">        <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aFilters">aFilters</a><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">] </span>= <span class="src-var">$mCallable</span><span class="src-sym">;</span></li>
<li><a name="a1368"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a1369"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1370"></a>&nbsp;</li>
<li><a name="a1371"></a><span class="src-str">    /**</span></li>
<li><a name="a1372"></a><span class="src-str">     * Unregister output filter</span></li>
<li><a name="a1373"></a><span class="src-str">     *</span></li>
<li><a name="a1374"></a><span class="src-str">     * @param string Name</span></li>
<li><a name="a1375"></a><span class="src-str">     * @return object</span></li>
<li><a name="a1376"></a><span class="src-str">     */</span></li>
<li><a name="a1377"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">unregisterFilter</span><span class="src-sym">(</span><span class="src-var">$sName</span><span class="src-sym">)</span></span></li>
<li><a name="a1378"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1379"></a><span class="src-str">        unset<span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../phpHaml/Haml/HamlParser.html#var$aFilters">aFilters</a><span class="src-sym">[</span><span class="src-var">$sName</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1380"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">;</span></li>
<li><a name="a1381"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1382"></a>&nbsp;</li>
<li><a name="a1383"></a><span class="src-str">    /**</span></li>
<li><a name="a1384"></a><span class="src-str">     * Return array of template variables</span></li>
<li><a name="a1385"></a><span class="src-str">     *</span></li>
<li><a name="a1386"></a><span class="src-str">     * @return array</span></li>
<li><a name="a1387"></a><span class="src-str">     */</span></li>
<li><a name="a1388"></a><span class="src-str">    <span class="src-key">public</span> <span class="src-key">function</span> <span class="src-id">getVariables</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1389"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1390"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$aVariables</span><span class="src-sym">;</span></span></li>
<li><a name="a1391"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1392"></a>&nbsp;</li>
<li><a name="a1393"></a><span class="src-str">    /**</span></li>
<li><a name="a1394"></a><span class="src-str">     * Parse variable in square brackets</span></li>
<li><a name="a1395"></a><span class="src-str">     *</span></li>
<li><a name="a1396"></a><span class="src-str">     * @param mixed Variable</span></li>
<li><a name="a1397"></a><span class="src-str">     * @return array Attributes</span></li>
<li><a name="a1398"></a><span class="src-str">     */</span></li>
<li><a name="a1399"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">parseSquareBrackets</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">)</span></span></li>
<li><a name="a1400"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1401"></a><span class="src-str">        <span class="src-var">$sType</span> = <span class="src-id">gettype</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1402"></a><span class="src-str">        <span class="src-var">$aAttr</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1403"></a><span class="src-str">        <span class="src-var">$sId</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a1404"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$sType</span> == <span class="src-str">'object'</span><span class="src-sym">)</span></span></li>
<li><a name="a1405"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a1406"></a><span class="src-str">            <span class="src-key">static</span> <span class="src-var">$__objectNamesCache</span><span class="src-sym">;</span></span></li>
<li><a name="a1407"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_array</span><span class="src-sym">(</span><span class="src-var">$__objectNamesCache</span><span class="src-sym">))</span></span></li>
<li><a name="a1408"></a><span class="src-str">                <span class="src-var">$__objectNamesCache</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1409"></a><span class="src-str">            <span class="src-var">$sClass</span> = <span class="src-id">get_class</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1410"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">array_key_existS</span><span class="src-sym">(</span><span class="src-var">$sClass</span><span class="src-sym">,</span> <span class="src-var">$__objectNamesCache</span><span class="src-sym">))</span></span></li>
<li><a name="a1411"></a><span class="src-str">                <span class="src-var">$__objectNamesCache</span><span class="src-sym">[</span><span class="src-var">$sClass</span><span class="src-sym">]</span> = <span class="src-var">$sType</span> = <span class="src-id">trim</span><span class="src-sym">(</span><span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'/([A-Z][a-z]*)/'</span><span class="src-sym">,</span> <span class="src-str">'$1_'</span><span class="src-sym">,</span> <span class="src-var">$sClass</span><span class="src-sym">)</span><span class="src-sym">,</span> <span class="src-str">'_'</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1412"></a><span class="src-str">            <span class="src-key">else</span></span></li>
<li><a name="a1413"></a><span class="src-str">                <span class="src-var">$sType</span> = <span class="src-var">$__objectNamesCache</span><span class="src-sym">[</span><span class="src-var">$sClass</span><span class="src-sym">]</span><span class="src-sym">;</span></span></li>
<li><a name="a1414"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-id">method_exists</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">,</span> <span class="src-str">'getID'</span><span class="src-sym">))</span></span></li>
<li><a name="a1415"></a><span class="src-str">                <span class="src-var">$sId</span> = <span class="src-var">$mVariable</span></span><span class="src-sym">-&gt;</span><span class="src-id">getID</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-key">else</span></li>
<li><a name="a1416"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">-&gt;</span><span class="src-id">ID</span><span class="src-sym">))</span></li>
<li><a name="a1417"></a>                <span class="src-var">$sId </span>= <span class="src-var">$mVariable</span><span class="src-sym">-&gt;</span><span class="src-id">ID</span><span class="src-sym">;</span></li>
<li><a name="a1418"></a>        <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1419"></a><span class="src-str">        <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$sId</span> == <span class="src-str">''</span><span class="src-sym">)</span></span></li>
<li><a name="a1420"></a><span class="src-str">            <span class="src-var">$sId</span> = <span class="src-id">substr</span><span class="src-sym">(</span><span class="src-id">md5</span><span class="src-sym">(</span><span class="src-id">uniqid</span><span class="src-sym">(</span><span class="src-id">serialize</span><span class="src-sym">(</span><span class="src-var">$mVariable</span><span class="src-sym">)</span>.<span class="src-id">rand</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span> <span class="src-id">true</span><span class="src-sym">))</span><span class="src-sym">,</span> <span class="src-num">0</span><span class="src-sym">,</span> <span class="src-num">8</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1421"></a><span class="src-str">        <span class="src-var">$aAttr</span><span class="src-sym">[</span><span class="src-str">'class'</span><span class="src-sym">]</span> = <span class="src-id">strtolower</span><span class="src-sym">(</span><span class="src-var">$sType</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1422"></a><span class="src-str">        <span class="src-var">$aAttr</span><span class="src-sym">[</span><span class="src-str">'id'</span><span class="src-sym">]</span> = <span class="src-str">"</span></span>{<span class="src-var">$aAttr</span><span class="src-sym">[</span><span class="src-str">'class'</span><span class="src-sym">]<span class="src-str"></span><span class="src-sym">}</span><span class="src-id">_</span><span class="src-var">$sId</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a1423"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$aAttr</span><span class="src-sym">;</span></span></li>
<li><a name="a1424"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1425"></a>&nbsp;</li>
<li><a name="a1426"></a><span class="src-str">    /**</span></li>
<li><a name="a1427"></a><span class="src-str">     * Write attributes</span></li>
<li><a name="a1428"></a><span class="src-str">     */</span></li>
<li><a name="a1429"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">writeAttributes</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1430"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1431"></a><span class="src-str">        <span class="src-var">$aAttr</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1432"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-id">func_get_args</span><span class="src-sym">(</span><span class="src-sym">)</span> <span class="src-key">as</span> <span class="src-var">$aArray</span><span class="src-sym">)</span></span></li>
<li><a name="a1433"></a><span class="src-str">            <span class="src-var">$aAttr</span> = <span class="src-id">array_merge</span><span class="src-sym">(</span><span class="src-var">$aAttr</span><span class="src-sym">,</span> <span class="src-var">$aArray</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1434"></a><span class="src-str">        <span class="src-id">ksort</span><span class="src-sym">(</span><span class="src-var">$aAttr</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1435"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aAttr</span> <span class="src-key">as</span> <span class="src-var">$sName</span> =&gt; <span class="src-var">$sValue</span><span class="src-sym">)</span></span></li>
<li><a name="a1436"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-var">$sValue</span><span class="src-sym">)</span></span></li>
<li><a name="a1437"></a><span class="src-str">                echo <span class="src-str">"</span> <span class="src-var">$sName</span>=\&quot;<span class="src-str">"</span>.<span class="src-id">htmlentities</span><span class="src-sym">(</span><span class="src-var">$sValue</span><span class="src-sym">)</span>.<span class="src-str">'&quot;'</span><span class="src-sym">;</span></span></li>
<li><a name="a1438"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1439"></a>&nbsp;</li>
<li><a name="a1440"></a><span class="src-str">    /**</span></li>
<li><a name="a1441"></a><span class="src-str">     * Export array</span></li>
<li><a name="a1442"></a><span class="src-str">     *</span></li>
<li><a name="a1443"></a><span class="src-str">     * @return string</span></li>
<li><a name="a1444"></a><span class="src-str">     */</span></li>
<li><a name="a1445"></a><span class="src-str">    <span class="src-key">protected</span> <span class="src-key">function</span> <span class="src-id">arrayExport</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a1446"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1447"></a><span class="src-str">        <span class="src-var">$sArray</span> = <span class="src-str">'array ('</span><span class="src-sym">;</span></span></li>
<li><a name="a1448"></a><span class="src-str">        <span class="src-var">$aArray</span> = <span class="src-var">$aNArray</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1449"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-id">func_get_args</span><span class="src-sym">(</span><span class="src-sym">)</span> <span class="src-key">as</span> <span class="src-var">$aArg</span><span class="src-sym">)</span></span></li>
<li><a name="a1450"></a><span class="src-str">            <span class="src-var">$aArray</span> = <span class="src-id">array_merge</span><span class="src-sym">(</span><span class="src-var">$aArray</span><span class="src-sym">,</span> <span class="src-var">$aArg</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1451"></a><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$aArray</span> <span class="src-key">as</span> <span class="src-var">$sKey</span> =&gt; <span class="src-var">$sValue</span><span class="src-sym">)</span></span></li>
<li><a name="a1452"></a><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a1453"></a><span class="src-str">            <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'/^[\'$&quot;a-zA-Z0-9]/'</span><span class="src-sym">,</span> <span class="src-var">$sValue</span><span class="src-sym">))</span></span></li>
<li><a name="a1454"></a><span class="src-str">                <span class="src-var">$sValue</span> = <span class="src-str">"</span>'<span class="src-var">$sValue</span>'<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a1455"></a><span class="src-str">            <span class="src-var">$aNArray</span><span class="src-sym">[</span><span class="src-sym">]</span> = <span class="src-str">"</span>'<span class="src-var">$sKey</span>' =&gt; <span class="src-var">$sValue</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a1456"></a><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a1457"></a><span class="src-str">        <span class="src-var">$sArray</span> .= <span class="src-id">implode</span><span class="src-sym">(</span><span class="src-str">', '</span><span class="src-sym">,</span> <span class="src-var">$aNArray</span><span class="src-sym">)</span>.<span class="src-str">')'</span><span class="src-sym">;</span></span></li>
<li><a name="a1458"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$sArray</span><span class="src-sym">;</span></span></li>
<li><a name="a1459"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1460"></a><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1461"></a>&nbsp;</li>
<li><a name="a1462"></a><span class="src-str"><span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">function_exists</span><span class="src-sym">(</span><span class="src-str">'fake_translate'</span><span class="src-sym">))</span></span></li>
<li><a name="a1463"></a><span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a1464"></a><span class="src-str">    /**</span></li>
<li><a name="a1465"></a><span class="src-str">     * Fake translation function used</span></li>
<li><a name="a1466"></a><span class="src-str">     * as default translation function</span></li>
<li><a name="a1467"></a><span class="src-str">     * in HamlParser</span></li>
<li><a name="a1468"></a><span class="src-str">     *</span></li>
<li><a name="a1469"></a><span class="src-str">     * @param string</span></li>
<li><a name="a1470"></a><span class="src-str">     * @return string</span></li>
<li><a name="a1471"></a><span class="src-str">     */</span></li>
<li><a name="a1472"></a><span class="src-str">    <span class="src-key">function</span> <span class="src-id">fake_translate</span><span class="src-sym">(</span><span class="src-var">$s</span><span class="src-sym">)</span></span></li>
<li><a name="a1473"></a><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a1474"></a><span class="src-str">        <span class="src-key">return</span> <span class="src-var">$s</span><span class="src-sym">;</span></span></li>
<li><a name="a1475"></a><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a1476"></a><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1477"></a>&nbsp;</li>
<li><a name="a1478"></a><span class="src-str">/**</span></li>
<li><a name="a1479"></a><span class="src-str"> * This is the simpliest way to use Haml</span></li>
<li><a name="a1480"></a><span class="src-str"> * templates. Global variables are</span></li>
<li><a name="a1481"></a><span class="src-str"> * automatically assigned to template.</span></li>
<li><a name="a1482"></a><span class="src-str"> *</span></li>
<li><a name="a1483"></a><span class="src-str"> * &lt;code&gt;</span></li>
<li><a name="a1484"></a><span class="src-str"> * $x = 10;</span></li>
<li><a name="a1485"></a><span class="src-str"> * $y = 5;</span></li>
<li><a name="a1486"></a><span class="src-str"> * display_haml('my.haml'); // Simple??</span></li>
<li><a name="a1487"></a><span class="src-str"> * &lt;/code&gt;</span></li>
<li><a name="a1488"></a><span class="src-str"> *</span></li>
<li><a name="a1489"></a><span class="src-str"> * @param string Haml parser filename</span></li>
<li><a name="a1490"></a><span class="src-str"> * @param array Associative array of additional variables</span></li>
<li><a name="a1491"></a><span class="src-str"> * @param string Temporary directory (default is directory of Haml templates)</span></li>
<li><a name="a1492"></a><span class="src-str"> * @param boolean Register get, post, session, server and cookie variables</span></li>
<li><a name="a1493"></a><span class="src-str"> */</span></li>
<li><a name="a1494"></a><span class="src-str"><span class="src-key">function</span> <span class="src-id">display_haml</span><span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">,</span> <span class="src-var">$aVariables</span> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span> <span class="src-var">$sTmp</span> = <span class="src-id">true</span><span class="src-sym">,</span> <span class="src-var">$bGPSSC</span> = <span class="src-id">false</span><span class="src-sym">)</span></span></li>
<li><a name="a1495"></a><span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a1496"></a><span class="src-str">    <span class="src-key">global</span> <span class="src-var">$__oHaml</span><span class="src-sym">;</span></span></li>
<li><a name="a1497"></a><span class="src-str">    <span class="src-var">$sPath</span> = <span class="src-id">realpath</span><span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1498"></a><span class="src-str">    <span class="src-key">if</span> <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_object</span><span class="src-sym">(</span><span class="src-var">$__oHaml</span><span class="src-sym">))</span></span></li>
<li><a name="a1499"></a><span class="src-str">        <span class="src-var">$__oHaml</span> = <span class="src-key">new</span> <span class="src-id">HamlParser</span><span class="src-sym">(</span><span class="src-id">dirname</span><span class="src-sym">(</span><span class="src-var">$sPath</span><span class="src-sym">)</span><span class="src-sym">,</span> <span class="src-var">$sTmp</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a1500"></a><span class="src-str">    <span class="src-var">$__oHaml</span></span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$GLOBALS</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1501"></a>    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$bGPSSC</span><span class="src-sym">)</span></li>
<li><a name="a1502"></a>    <span class="src-str"><span class="src-sym">{</span></span></li>
<li><a name="a1503"></a><span class="src-str">        <span class="src-var">$__oHaml</span></span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1504"></a>        <span class="src-var">$__oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1505"></a>        <span class="src-var">$__oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1506"></a>        <span class="src-var">$__oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1507"></a>        <span class="src-var">$__oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1508"></a>    <span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1509"></a><span class="src-str">    <span class="src-var">$__oHaml</span></span><span class="src-sym">-&gt;</span><span class="src-id">append</span><span class="src-sym">(</span><span class="src-var">$aVariables</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1510"></a>    <span class="src-var">$__oHaml</span><span class="src-sym">-&gt;</span><span class="src-id">display</span><span class="src-sym">(</span><span class="src-var">$sFilename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1511"></a><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a1512"></a>&nbsp;</li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 09 Jul 2007 10:05:05 +0200 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</p>
	</body>
</html>